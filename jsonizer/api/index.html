<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Jsonizer - v1.0.2</title>
	<meta name="description" content="Documentation for Jsonizer - v1.0.2">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">Jsonizer - v1.0.2</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>Jsonizer - v1.0.2</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#jsonizer" id="jsonizer" style="color: inherit; text-decoration: none;">
					<h1>Jsonizer</h1>
				</a>
				<div class="nopub" style='margin: 20px; padding: 20px; border: solid 3px'>
					<a href="http://badcafe.github.io/jsonizer">Published version of this page available HERE</a>
					<br/>
				</div>
				<blockquote>
					<p><strong>Easy nested instance reviving for JSON</strong></p>
				</blockquote>
				<p><code>@badcafe/jsonizer</code> <img style="float: right" src="matryoshka.svg" width="50%"/> is a <a href="https://www.typescriptlang.org/">Typescript</a> library that takes care of instances of classes in the hierarchy of your data structure when you use <code>JSON.stringify()</code> and <code>JSON.parse()</code>.</p>
				<p>Jsonizer mainly supplies a decorator (<code>@Reviver</code>) that describes how to revive classes, and two helper functions (<code>Jsonizer.reviver()</code> and <code>Jsonizer.replacer()</code>).</p>
				<p>Jsonizer can indifferently revive JSON data structures (arrays, objects) or class instances with recursively nested custom classes, third-party classes, built-in classes, or sub JSON structures (arrays, objects).</p>
				<a href="#license" id="license" style="color: inherit; text-decoration: none;">
					<h3>License</h3>
				</a>
				<p><a href="https://github.com/badcafe/jsonizer/blob/master/LICENSE.txt">MIT</a></p>
				<a href="#install" id="install" style="color: inherit; text-decoration: none;">
					<h3>Install</h3>
				</a>
				<pre><code class="language-bash"><span style="color: #000000">npm install @badcafe/jsonizer</span>
</code></pre>
				<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
					<h3>Usage</h3>
				</a>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">, </span><span style="color: #001080">Reviver</span><span style="color: #000000">, </span><span style="color: #001080">Replacer</span><span style="color: #000000">, </span><span style="color: #001080">Mappers</span><span style="color: #000000">, </span><span style="color: #001080">Namespace</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;@badcafe/jsonizer&#039;</span><span style="color: #000000">;</span>
<span style="color: #008000">// then see examples below</span>
</code></pre>
				<p>If you intend to use <code>@Reviver</code> as a decorator set the relevant flag in <code>tsconfig.json</code> :</p>
				<pre><code class="language-json"><span style="color: #A31515">&quot;compilerOptions&quot;</span><span style="color: #000000">: {</span>
<span style="color: #000000">    </span><span style="color: #0451A5">&quot;experimentalDecorators&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>For other transpilers (<a href="https://babeljs.io/">Babel</a>), please refer to the relevant documentation for activating decorators.</p>
				<blockquote>
					<p>Decorators are not mandatory: there is an alternative, see below...</p>
				</blockquote>
				<a href="#overview" id="overview" style="color: inherit; text-decoration: none;">
					<h2>Overview</h2>
				</a>
				<a href="#what-are-we-talking-about-" id="what-are-we-talking-about-" style="color: inherit; text-decoration: none;">
					<h3>What are we talking about ?</h3>
				</a>
				<p>Let&#39;s start with a simple data structure :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">person</span><span style="color: #000000"> = {</span>
<span style="color: #000000">    </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;Bob&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;1998-10-21&#039;</span><span style="color: #000000">)</span>
<span style="color: #000000">}</span>
<span style="color: #001080">person</span><span style="color: #000000">.</span><span style="color: #001080">birthDate</span><span style="color: #000000">.</span><span style="color: #795E26">getFullYear</span><span style="color: #000000">();</span>
<span style="color: #008000">// 1998</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">person</span><span style="color: #000000">);</span>
<span style="color: #008000">// {   &quot;name&quot;:&quot;Bob&quot;,</span>
<span style="color: #008000">//     &quot;birthDate&quot;:&quot;1998-10-21T00:00:00.000Z&quot;</span>
<span style="color: #008000">// }</span>
<span style="color: #008000">// store or send the data</span>
</code></pre>
				<p>So far so good. Let&#39;s try to get back the data structure without Jsonizer :</p>
				<pre><code class="language-typescript"><span style="color: #008000">// respawn the person</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personFromJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">personJson</span><span style="color: #000000">);</span>
<span style="color: #001080">personFromJson</span><span style="color: #000000">.</span><span style="color: #001080">birthDate</span><span style="color: #000000">.</span><span style="color: #795E26">getFullYear</span><span style="color: #000000">();</span>
<span style="color: #008000">// Uncaught TypeError: personFromJson.birthDate.getFullYear is not a function</span>
<span style="color: #008000">// üòµ  oh no ! it is broken</span>
<span style="color: #0000FF">typeof</span><span style="color: #000000"> </span><span style="color: #001080">personFromJson</span><span style="color: #000000">.</span><span style="color: #001080">birthDate</span><span style="color: #000000">;</span>
<span style="color: #008000">// string</span>
<span style="color: #008000">// üò°  wrong type !</span>
</code></pre>
				<p>Instead, let&#39;s use Jsonizer üòç</p>
				<pre><code class="language-typescript"><span style="color: #008000">// in Jsonizer, a reviver is made of field mappings</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personReviver</span><span style="color: #000000"> = </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #795E26">reviver</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">typeof</span><span style="color: #000000"> </span><span style="color: #001080">person</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000"> </span><span style="color: #008000">// üëà  we need a mapping only for this field</span>
<span style="color: #000000">});</span>
<span style="color: #008000">// pass our reviver as 2nd argument of JSON.parse() üëá</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personFromJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">personJson</span><span style="color: #000000">, </span><span style="color: #001080">personReviver</span><span style="color: #000000">);</span>
<span style="color: #008000">// bonus : üëÜ personFromJson is typed !</span>
<span style="color: #001080">personFromJson</span><span style="color: #000000">.</span><span style="color: #001080">birthDate</span><span style="color: #000000">.</span><span style="color: #795E26">getFullYear</span><span style="color: #000000">();</span>
<span style="color: #008000">// 1998</span>
<span style="color: #008000">// üëç  expected value</span>
<span style="color: #0000FF">typeof</span><span style="color: #000000"> </span><span style="color: #001080">personFromJson</span><span style="color: #000000">.</span><span style="color: #001080">birthDate</span>
<span style="color: #008000">// object</span>
<span style="color: #001080">personFromJson</span><span style="color: #000000">.</span><span style="color: #001080">birthDate</span><span style="color: #000000">.</span><span style="color: #001080">constructor</span>
<span style="color: #008000">// Date</span>
<span style="color: #008000">// üëå  everything is fine</span>
</code></pre>
				<p>Above, <code>Jsonizer.reviver&lt;typeof person&gt;()</code> is parameterized with the target type ; since we have hardcoded data in this example, we are getting it with <code>typeof person</code>. In a real app, we would have -say- an interface <code>Person</code> and therefore we would use <code>Jsonizer.reviver&lt;Person&gt;()</code>. Using types enforce the mappings to describe fields that exist in the target data structure.</p>
				<p>Only the fields that are not basic javascript types (array, object, number, string, boolean, null) have to be described by a mapping, made of the field name and its reviver. The <code>birthDate</code> field is the only field that requires a mapping, and its reviver is the one bound to the <code>Date</code> native function. Behind the scene, Jsonizer ships the <code>Date</code> function with its reviver, so nothing special have to be done. We will see later how to bind revivers to custom classes, third-party classes, and other built-in classes.</p>
				<a href="#jsonizer-features" id="jsonizer-features" style="color: inherit; text-decoration: none;">
					<h3>Jsonizer features</h3>
				</a>
				<ul>
					<li>Jsonizer relies on standard <code>JSON.parse(text, reviver?)</code> and <code>JSON.stringify(value, replacer?, space?)</code> functions.</li>
					<li>Jsonizer <strong>reifies the hierachy missing</strong> when using the <code>reviver</code> or <code>replacer</code> functions.</li>
					<li>Jsonizer&#39;s revivers can <strong>augment the data</strong> by performing the reverse operation of objects stringification with enough flexibility, so that classes are allowed to define their own <code>toJSON()</code> functions.</li>
					<li>Jsonizer field mapping facilities include the joker <code>&#39;*&#39;</code> to match any field, as well as Regexp for objects keys and ranges for arrays items.</li>
					<li>Jsonizer is for JSON, and doesn&#39;t handle <code>undefined</code>, functions, or symbols. It doesn&#39;t either handle circular references (because <code>JSON.stringify()</code> doesn&#39;t handle them), except if <code>toJSON()</code> get rid of them and that the builder function of Jsonizer&#39;s revivers recreate them.</li>
					<li>Jsonizer can spawn itself the revivers for general purpose stringification and parsing, that can be stored or sent with the data payload.</li>
					<li>Jsonizer takes care of class name conflicts by introducing a simple yet powerful namespace feature.</li>
					<li>Jsonizer is made in Typescript for Typescript, and thanks to the type system will help developers to design easily their mappings.</li>
					<li>Jsonizer works in the browser as well as server-side.</li>
				</ul>
				<a href="#revivers-mappings" id="revivers-mappings" style="color: inherit; text-decoration: none;">
					<h2>Revivers mappings</h2>
				</a>
				<p>In Jsonizer, a data structure can be <strong>augmented</strong> to typed data thanks to mappers. Mappers are plain objects that contain an entry for each field to augment.</p>
				<a href="#objects" id="objects" style="color: inherit; text-decoration: none;">
					<h3>Objects</h3>
				</a>
				<p>Let&#39;s define a type for the previous example. As a structural type system, Typescript allow us to describe the shape of our data :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">interface</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">}</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personReviver</span><span style="color: #000000"> = </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #795E26">reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">&gt;({ </span><span style="color: #008000">// üëà  revive a Person</span>
<span style="color: #000000">    </span><span style="color: #008000">// Typescript will check the fields that you can map</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">});</span>
<span style="color: #008000">// the type of personFromJson is inferred and set to Person</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personFromJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">personJson</span><span style="color: #000000">, </span><span style="color: #001080">personReviver</span><span style="color: #000000">);</span>
<span style="color: #008000">// its name is left as-is (a string), but its birthDate is a Date instance üëç </span>
</code></pre>
				<a href="#arrays" id="arrays" style="color: inherit; text-decoration: none;">
					<h3>Arrays</h3>
				</a>
				<p>In the following example, we introduce the &#39;any&#39; key <code>&#39;*&#39;</code> that matches any item of an array or any field of an object.</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">persons</span><span style="color: #000000">: </span><span style="color: #267F99">Person</span><span style="color: #000000">[] = [</span>
<span style="color: #000000">    {   </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;Bob&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;1998-10-21&#039;</span><span style="color: #000000">)</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">    {   </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;Alice&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;2002-04-01&#039;</span><span style="color: #000000">)</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">];</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personsJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">persons</span><span style="color: #000000">);</span>
<span style="color: #008000">// store or send the data</span>
</code></pre>
				<p>We already have a definition for each person item of the array. Jsonizer allow to define simply the mapping of all items :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personsReviver</span><span style="color: #000000"> = </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #795E26">reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">[]&gt;({ </span><span style="color: #008000">// üëà revive an array of Person</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;*&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> { </span><span style="color: #008000">// üëà  a &#039;joker&#039; entry for matching Any array item</span>
<span style="color: #000000">        </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">});</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personsFromJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">personsJson</span><span style="color: #000000">, </span><span style="color: #001080">personsReviver</span><span style="color: #000000">);</span>
<span style="color: #008000">// its type üëÜ is Person[]</span>
</code></pre>
				<a href="#nested-mappings" id="nested-mappings" style="color: inherit; text-decoration: none;">
					<h3>Nested mappings</h3>
				</a>
				<p>Let&#39;s go on with a little more complex data structure, with arrays and nested objects :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">person</span><span style="color: #000000"> = {</span>
<span style="color: #000000">    </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;Bob&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;1998-10-21&#039;</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #001080">hobbies:</span><span style="color: #000000"> [</span>
<span style="color: #000000">        {   </span><span style="color: #001080">hobby:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;programming&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">            </span><span style="color: #001080">startDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;2021-01-01&#039;</span><span style="color: #000000">),</span>
<span style="color: #000000">        },</span>
<span style="color: #000000">        {   </span><span style="color: #001080">hobby:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;cooking&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">            </span><span style="color: #001080">startDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;2020-12-31&#039;</span><span style="color: #000000">),</span>
<span style="color: #000000">        },</span>
<span style="color: #000000">    ]</span>
<span style="color: #000000">}</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">person</span><span style="color: #000000">);</span>
<span style="color: #008000">// store or send the data</span>
</code></pre>
				<p>Like a person, a hobby also has a date, but what is important here is that the <code>hobbies</code> field is an array of hobby :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personReviver</span><span style="color: #000000"> = </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #795E26">reviver</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">typeof</span><span style="color: #000000"> </span><span style="color: #001080">person</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">hobbies:</span><span style="color: #000000"> { </span><span style="color: #008000">// begin the mappings for an array</span>
<span style="color: #000000">        </span><span style="color: #A31515">&#039;*&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> { </span><span style="color: #008000">// begin the mappings for a single item</span>
<span style="color: #000000">            </span><span style="color: #001080">startDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">});</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personFromJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">personJson</span><span style="color: #000000">, </span><span style="color: #001080">personReviver</span><span style="color: #000000">);</span>
</code></pre>
				<p>The thing to notice is that it is possible to define a mapping at each level in the hierarchy.</p>
				<a href="#tuples" id="tuples" style="color: inherit; text-decoration: none;">
					<h3>Tuples</h3>
				</a>
				<p>A tuple is an array with a fixed length and potentially different item types :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">type</span><span style="color: #000000"> </span><span style="color: #267F99">Employee</span><span style="color: #000000"> = [</span><span style="color: #267F99">Person</span><span style="color: #000000">, </span><span style="color: #267F99">Date</span><span style="color: #000000">]; </span><span style="color: #008000">// üëà  our tuple type</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">employee</span><span style="color: #000000">: </span><span style="color: #267F99">Employee</span><span style="color: #000000"> = [</span>
<span style="color: #000000">    {   </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;Bob&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;1998-10-21&#039;</span><span style="color: #000000">)</span>
<span style="color: #000000">    }, </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;2010-06-01&#039;</span><span style="color: #000000">)</span>
<span style="color: #000000">];</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">employeeReviver</span><span style="color: #000000"> = </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #795E26">reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Employee</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #098658">0</span><span style="color: #001080">:</span><span style="color: #000000"> { </span><span style="color: #008000">// üëà  first tuple item</span>
<span style="color: #000000">        </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">    </span><span style="color: #098658">1</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">  </span><span style="color: #008000">// üëà  second tuple item</span>
<span style="color: #000000">});</span>
</code></pre>
				<p>We might define the reviver for an array of employees :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">employeesReviver</span><span style="color: #000000"> = </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #795E26">reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Employee</span><span style="color: #000000">[]&gt;({ </span><span style="color: #008000">// üëà  Employee[] here</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;*&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #098658">0</span><span style="color: #001080">:</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">        },</span>
<span style="color: #000000">        </span><span style="color: #098658">1</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">});</span>
</code></pre>
				<p>It is possible to mix the &#39;any&#39; key <code>&#39;*&#39;</code> with numeric keys : in that case, <code>&#39;*&#39;</code> is just the mapper for all keys that are not matched by numeric keys.</p>
				<a href="#classes" id="classes" style="color: inherit; text-decoration: none;">
					<h2>Classes</h2>
				</a>
				<p>Jsonizer supplies the decorator function <code>@Reviver</code> that allows to bind easily some mappings to a class.</p>
				<blockquote>
					<p>You ought decorate your classes with <code>@Namespace</code> too if you intend to share your code in a lib (more about that later in this doc).</p>
				</blockquote>
				<a href="#custom-classes" id="custom-classes" style="color: inherit; text-decoration: none;">
					<h3>Custom classes</h3>
				</a>
				<p>In the following example, we introduce the &#39;self&#39; key <code>&#39;.&#39;</code>. Unlike other entries, it is not bound to <strong>a mapper</strong> but to <strong>a builder function</strong> that is supposed to create a new instance of the expected class. The builder function takes as argument the object that contains the values parsed and mapped to their type. This means that below, the <code>birthDate</code> argument passed to the constructor is already a <code>Date</code> instance (because there is a mapping that had augmented it).</p>
				<pre><code class="language-typescript"><span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">&gt;({ </span><span style="color: #008000">// üëà  bind the reviver to the class</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> ({</span><span style="color: #001080">name</span><span style="color: #000000">, </span><span style="color: #001080">birthDate</span><span style="color: #000000">}) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Person</span><span style="color: #000000">(</span><span style="color: #001080">name</span><span style="color: #000000">, </span><span style="color: #001080">birthDate</span><span style="color: #000000">), </span><span style="color: #008000">// üëà  instance builder</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">})</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">( </span><span style="color: #008000">// all fields are passed as arguments to the constructor</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">    ) {}</span>
<span style="color: #000000">}</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">person</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Person</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Bob&#039;</span><span style="color: #000000">, </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;1998-10-21&#039;</span><span style="color: #000000">));</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">person</span><span style="color: #000000">);</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personReviver</span><span style="color: #000000"> = </span><span style="color: #001080">Reviver</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #001080">Person</span><span style="color: #000000">); </span><span style="color: #008000">// üëà  extract the reviver from the class</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personFromJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">personJson</span><span style="color: #000000">, </span><span style="color: #001080">personReviver</span><span style="color: #000000">);</span>
</code></pre>
				<p>The <strong>builder function</strong> can be more complex than the one shown here (see later).</p>
				<a href="#self-apply" id="self-apply" style="color: inherit; text-decoration: none;">
					<h3>Self apply</h3>
				</a>
				<p>The use case above is a common pattern where all the arguments are passed to the constructor. Jsonizer supplies a builder that does the job :</p>
				<pre><code class="language-typescript"><span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #001080">Self</span><span style="color: #000000">.</span><span style="color: #795E26">apply</span><span style="color: #000000">(</span><span style="color: #001080">Person</span><span style="color: #000000">), </span><span style="color: #008000">// üëà  same instance builder as above</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">})</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">    ) {}</span>
<span style="color: #000000">}</span>
</code></pre>
				<blockquote>
					<p>If some arguments are optional, then you certainly have to customize the builder. Be aware that during stringification, fields set to <code>undefined</code> will be skipped whereas fields set to <code>null</code> will be present in the JSON text.</p>
				</blockquote>
				<a href="#self-assign" id="self-assign" style="color: inherit; text-decoration: none;">
					<h3>Self assign</h3>
				</a>
				<p>There is another common pattern where the constructor is empty, and each field has to be populated with the incoming data. Jsonizer supplies once again a builder that does the job :</p>
				<pre><code class="language-typescript"><span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #001080">Self</span><span style="color: #000000">.</span><span style="color: #795E26">assign</span><span style="color: #000000">(</span><span style="color: #001080">Person</span><span style="color: #000000">), </span><span style="color: #008000">// üëà assign each field to the new instance</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">})</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {  </span><span style="color: #008000">// no constructor, fields have to be assigned one by one</span>
<span style="color: #000000">    </span><span style="color: #001080">name</span><span style="color: #000000">?: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate</span><span style="color: #000000">?: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#no--decorator" id="no--decorator" style="color: inherit; text-decoration: none;">
					<h3>No @ decorator</h3>
				</a>
				<p>Either you don&#39;t want to activate decorators in your project, or you want to bind a reviver to third-party classes or built-in classes, it is still possible to use <code>Reviver</code> as a &#39;normal&#39; function :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">    ) {}</span>
<span style="color: #000000">}</span>

<span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> ({</span><span style="color: #001080">name</span><span style="color: #000000">, </span><span style="color: #001080">birthDate</span><span style="color: #000000">}) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Person</span><span style="color: #000000">(</span><span style="color: #001080">name</span><span style="color: #000000">, </span><span style="color: #001080">birthDate</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">})(</span><span style="color: #001080">Person</span><span style="color: #000000">) </span><span style="color: #008000">// üëà  apply it to the class = same effect as using it as a decorator</span>
</code></pre>
				<a href="#class-with-nested-json" id="class-with-nested-json" style="color: inherit; text-decoration: none;">
					<h3>Class with nested JSON</h3>
				</a>
				<pre><code class="language-typescript"><span style="color: #0000FF">interface</span><span style="color: #000000"> </span><span style="color: #267F99">Hobby</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">hobby</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">startDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">}</span>

<span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #001080">Self</span><span style="color: #000000">.</span><span style="color: #795E26">apply</span><span style="color: #000000">(</span><span style="color: #001080">Person</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">hobbies:</span><span style="color: #000000"> { </span><span style="color: #008000">// üëà this is not different as the first examples</span>
<span style="color: #000000">        </span><span style="color: #A31515">&#039;*&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #001080">startDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">})</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">hobbies</span><span style="color: #000000">?: </span><span style="color: #267F99">Hobby</span><span style="color: #000000">[]</span>
<span style="color: #000000">    ) {}</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#class-with-nested-class" id="class-with-nested-class" style="color: inherit; text-decoration: none;">
					<h3>Class with nested class</h3>
				</a>
				<pre><code class="language-typescript"><span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Hobby</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #001080">Self</span><span style="color: #000000">.</span><span style="color: #795E26">assign</span><span style="color: #000000">(</span><span style="color: #001080">Hobby</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #001080">startDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">})</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Hobby</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">hobby</span><span style="color: #000000">?: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">startDate</span><span style="color: #000000">?: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">}</span>

<span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #001080">Self</span><span style="color: #000000">.</span><span style="color: #795E26">apply</span><span style="color: #000000">(</span><span style="color: #001080">Person</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">hobbies:</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #A31515">&#039;*&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">Hobby</span><span style="color: #000000">  </span><span style="color: #008000">// üëà  we can refer a class decorated with @Reviver</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">})</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">hobbies</span><span style="color: #000000">?: </span><span style="color: #267F99">Hobby</span><span style="color: #000000">[]</span>
<span style="color: #000000">    ) {}</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#pass-through-identity" id="pass-through-identity" style="color: inherit; text-decoration: none;">
					<h3>Pass through (Identity)</h3>
				</a>
				<p>In any cases where you don&#39;t want a class but kept as-is the augmented data structure, you may create a pass-through class :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">interface</span><span style="color: #000000"> </span><span style="color: #267F99">Hobby</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">hobby</span><span style="color: #000000">?: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">startDate</span><span style="color: #000000">?: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">}</span>

<span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Hobby</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #001080">Self</span><span style="color: #000000">.</span><span style="color: #001080">Identity</span><span style="color: #000000">, </span><span style="color: #008000">// üëà  won&#039;t create an instance of Hobby</span>
<span style="color: #000000">    </span><span style="color: #001080">startDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">})</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">HobbyReviver</span><span style="color: #000000"> </span><span style="color: #0000FF">implements</span><span style="color: #000000"> </span><span style="color: #267F99">Hobby</span><span style="color: #000000"> {  </span><span style="color: #008000">// üëà  we won&#039;t have instances of that class</span>
<span style="color: #000000">    </span><span style="color: #001080">hobby</span><span style="color: #000000">?: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">startDate</span><span style="color: #000000">?: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">}</span>

<span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #001080">Self</span><span style="color: #000000">.</span><span style="color: #795E26">apply</span><span style="color: #000000">(</span><span style="color: #001080">Person</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">hobbies:</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #A31515">&#039;*&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">HobbyReviver</span><span style="color: #000000"> </span><span style="color: #008000">// üëà  just stands for a reviver reference</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">})</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">hobbies</span><span style="color: #000000">?: </span><span style="color: #267F99">Hobby</span><span style="color: #000000">[] </span><span style="color: #008000">// üëà  just a plain javascript object</span>
<span style="color: #000000">    ) {}</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>Above, we are using <code>Jsonizer.Self.Identity</code> to left as-is the incoming augmented data, but any custom function that returns whatever expected is suitable.</p>
				<blockquote>
					<p>The previous pattern applies to abstract classes or classes with a private or protected constructor and also to recursive data structure, since only classes can handle recursive mappings in Jsonizer.
					Whenever you expect a different class, instead of the identity you may build your instances with such utility classes.</p>
				</blockquote>
				<a href="#built-in-revivers" id="built-in-revivers" style="color: inherit; text-decoration: none;">
					<h3>Built-in revivers</h3>
				</a>
				<p>As mentionned previously, a mapper can refer a class decorated with <code>@Reviver</code>:</p>
				<ul>
					<li><code>&#39;*&#39;: Hobby  // üëà  user class </code></li>
					<li><code>birthDate: Date // üëà  javascript class </code></li>
				</ul>
				<p>Jsonizer supplies revivers for few built-in classes :</p>
				<ul>
					<li><code>Date</code>,</li>
					<li><code>RegExp</code>,</li>
					<li><code>Error</code></li>
				</ul>
				<p>Jsonizer&#39;s <code>Reviver</code> class has also its reviver, that allow <strong>to revive a reviver</strong> like any other class (see below).</p>
				<blockquote>
					<a href="#errors" id="errors" style="color: inherit; text-decoration: none;">
						<h4>Errors</h4>
					</a>
					<p>By default Javascript doesn&#39;t serialize the type and the message of an error :</p>
					<pre><code class="language-javascript"><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">TypeError</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Ooops !&#039;</span><span style="color: #000000">));</span>
<span style="color: #008000">// &#039;{}&#039;</span>
<span style="color: #008000">// for a custom error, only its own fields will be serialized</span>
</code></pre>
					<p>However Javascript can display a string representation :</p>
					<pre><code class="language-javascript"><span style="color: #267F99">String</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">TypeError</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Ooops !&#039;</span><span style="color: #000000">));</span>
<span style="color: #008000">// &#039;TypeError: Ooops !&#039;</span>
</code></pre>
					<p>By default, Asynchronizer will serialize that string representation, and will revive errors even if the error class is unknown. Custom errors can of course be processed like any other classes and will be revived if the error class is known at runtime.</p>
				</blockquote>
				<a href="#the-3939-self-builder" id="the-3939-self-builder" style="color: inherit; text-decoration: none;">
					<h3>The <code>&#39;.&#39;</code> (self) builder</h3>
				</a>
				<p>When entering a builder, the argument passed is the incoming data structured augmented so far, but Jsonizer supplies more context : <code>this</code> is set to a stack of the data structure hierarchy.</p>
				<ul>
					<li>Data in the parent hierarchy are parsed but not yet augmented.</li>
					<li>Previous siblings data are already parsed <strong>and augmented</strong>.</li>
					<li>Next siblings data are parsed but not yet augmented.</li>
				</ul>
				<p>(this is due to the bottom-up nature of <code>JSON.parse()</code>)</p>
				<pre><code class="language-typescript"><span style="color: #008000">// üí° you should first examine the data just after</span>
<span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000"> &amp; { </span><span style="color: #001080">hireDate</span><span style="color: #000000">?: </span><span style="color: #267F99">Date</span><span style="color: #000000"> }&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000">({</span><span style="color: #001080">name</span><span style="color: #000000">, </span><span style="color: #001080">birthDate</span><span style="color: #000000">, </span><span style="color: #001080">hireDate</span><span style="color: #000000">}) { </span><span style="color: #008000">// üëà a more complex builder</span>
<span style="color: #000000">        </span><span style="color: #008000">// &quot;this&quot; is an array of the hierarchy (we have 3 levels):</span>
<span style="color: #000000">        </span><span style="color: #008000">// root   = this[0]; // People[]</span>
<span style="color: #000000">        </span><span style="color: #008000">// parent = this[1]; // People = { type, person }</span>
<span style="color: #000000">        </span><span style="color: #008000">// self   = this[2]; // { name, birthDate, hireDate? }</span>
<span style="color: #000000">        </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">selfIndex</span><span style="color: #000000"> = </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">length</span><span style="color: #000000"> -</span><span style="color: #098658">1</span><span style="color: #000000">;</span>
<span style="color: #000000">        </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">parentIndex</span><span style="color: #000000"> = </span><span style="color: #001080">selfIndex</span><span style="color: #000000"> -</span><span style="color: #098658">1</span><span style="color: #000000">; </span><span style="color: #008000">// = this.length -2</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #0000FF">this</span><span style="color: #000000">[</span><span style="color: #001080">parentIndex</span><span style="color: #000000">].</span><span style="color: #001080">type</span><span style="color: #000000"> === </span><span style="color: #A31515">&#039;employee&#039;</span><span style="color: #000000">) {</span>
<span style="color: #000000">            </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Employee</span><span style="color: #000000">(</span><span style="color: #001080">name</span><span style="color: #000000">, </span><span style="color: #001080">birthDate</span><span style="color: #000000">, </span><span style="color: #001080">hireDate</span><span style="color: #000000">)</span>
<span style="color: #000000">        } </span><span style="color: #AF00DB">else</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Person</span><span style="color: #000000">(</span><span style="color: #001080">name</span><span style="color: #000000">, </span><span style="color: #001080">birthDate</span><span style="color: #000000">);</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">hireDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000"> </span><span style="color: #008000">// üëà don&#039;t forget to augment this date</span>
<span style="color: #000000">})</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">    ) {}</span>
<span style="color: #000000">}</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Employee</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">hireDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000"> </span><span style="color: #008000">// üëà an employee...</span>
<span style="color: #000000">    ) {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">super</span><span style="color: #000000">(</span><span style="color: #001080">name</span><span style="color: #000000">, </span><span style="color: #001080">birthDate</span><span style="color: #000000">);</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
<span style="color: #0000FF">type</span><span style="color: #000000"> </span><span style="color: #267F99">People</span><span style="color: #000000"> = {</span>
<span style="color: #000000">    </span><span style="color: #001080">type</span><span style="color: #000000">: </span><span style="color: #A31515">&#039;person&#039;</span>
<span style="color: #000000">    </span><span style="color: #001080">person</span><span style="color: #000000">: </span><span style="color: #267F99">Person</span>
<span style="color: #000000">} | {</span>
<span style="color: #000000">    </span><span style="color: #001080">type</span><span style="color: #000000">: </span><span style="color: #A31515">&#039;employee&#039;</span>
<span style="color: #000000">    </span><span style="color: #001080">person</span><span style="color: #000000">: </span><span style="color: #267F99">Employee</span>
<span style="color: #000000">}</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">people</span><span style="color: #000000">: </span><span style="color: #267F99">People</span><span style="color: #000000">[] = [ </span><span style="color: #008000">// üëà the data are a mix of Person and Employee</span>
<span style="color: #000000">    {   </span><span style="color: #001080">type:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;person&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">person:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Person</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Bob&#039;</span><span style="color: #000000">, </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;1998-10-21&#039;</span><span style="color: #000000">))</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">    {   </span><span style="color: #001080">type:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;employee&#039;</span>
<span style="color: #000000">        </span><span style="color: #001080">person</span><span style="color: #000000">: </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Employee</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Alice&#039;</span><span style="color: #000000">, </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;2002-04-01&#039;</span><span style="color: #000000">), </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;2010-06-01&#039;</span><span style="color: #000000">))</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">]</span>
</code></pre>
				<blockquote>
					<p>Above, since the indexes <code>selfIndex</code> and <code>parentIndex</code> used to extract the parent context are computed from <code>this.length</code>, this allow to be flexible enough to use that reviver even if the data were not an array of people. However, we suppose that a <code>Person</code> or an <code>Employee</code> is already built in the context of the <code>People</code> wrapper that has a <code>type</code> field.</p>
				</blockquote>
				<p>Of course, there is also the possibility to define a reviver for <code>Employee</code>, but here we demonstrate that other (external) data are available when building a new instance.</p>
				<a href="#dto" id="dto" style="color: inherit; text-decoration: none;">
					<h2>DTO</h2>
				</a>
				<p>Sometimes you have a class, that has its own shape, and you want to send it (as JSON) with another shape. The data exchanged are called <a href="https://en.wikipedia.org/wiki/Data_transfer_object">DTO</a>, for Data Transfer Object.</p>
				<a href="#tojson-and-dto" id="tojson-and-dto" style="color: inherit; text-decoration: none;">
					<h3><code>toJSON()</code> and DTO</h3>
				</a>
				<p>The mappers accept an additional type parameter for the DTO. By default, the type of the DTO source is the same as the target type, but Jsonizer allows to indicate a different type. Of course, this implies that the object serialization is not the default one performed by <code>JSON.stringify()</code> : javascript has a standard feature that allows to customize the serialization, by defining the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#tojson_behavior"><code>toJSON()</code> function</a> in such classes.</p>
				<p>The important thing is that the Jsonizer&#39;s self builder function of a class (bound to <code>&#39;.&#39;</code>) has to be somewhat the reverse function of its <code>toJSON()</code> function.</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">type</span><span style="color: #000000"> </span><span style="color: #267F99">PersonDTO</span><span style="color: #000000"> = {</span>
<span style="color: #000000">    </span><span style="color: #001080">name</span><span style="color: #000000">: [</span><span style="color: #267F99">string</span><span style="color: #000000">, </span><span style="color: #267F99">string</span><span style="color: #000000">]</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">string</span>
<span style="color: #000000">}</span>

<span style="color: #008000">//       Target   Source</span>
<span style="color: #008000">//         üëá        üëá                the builder is the reverse fctn of toJSON()</span>
<span style="color: #000000">@</span><span style="color: #267F99">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">, </span><span style="color: #267F99">PersonDTO</span><span style="color: #000000">&gt;({ </span><span style="color: #008000">//                   üëá</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #000000">: ({</span><span style="color: #001080">name</span><span style="color: #000000">: [</span><span style="color: #267F99">firstName</span><span style="color: #000000">, </span><span style="color: #267F99">lastName</span><span style="color: #000000">], </span><span style="color: #001080">birthDate</span><span style="color: #000000">}) </span><span style="color: #0000FF">=&gt;</span>
<span style="color: #000000">                            </span><span style="color: #267F99">new</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000">(</span><span style="color: #001080">firstName</span><span style="color: #000000">, </span><span style="color: #001080">lastName</span><span style="color: #000000">, </span><span style="color: #001080">new</span><span style="color: #000000"> </span><span style="color: #001080">Date</span><span style="color: #000000">(</span><span style="color: #001080">birthDate</span><span style="color: #000000">))</span>
<span style="color: #000000">})</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">firstName</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">lastName</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">    ) {}</span>
<span style="color: #000000">    </span><span style="color: #795E26">toJSON</span><span style="color: #000000">(): </span><span style="color: #267F99">PersonDTO</span><span style="color: #000000"> { </span><span style="color: #008000">// üëà  toJSON() is the reverse function of the builder</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #001080">name:</span><span style="color: #000000"> [</span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">firstName</span><span style="color: #000000">, </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">lastName</span><span style="color: #000000">],</span>
<span style="color: #000000">            </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">birthDate</span><span style="color: #000000">.</span><span style="color: #795E26">toISOString</span><span style="color: #000000">().</span><span style="color: #795E26">slice</span><span style="color: #000000">(</span><span style="color: #098658">0</span><span style="color: #000000">, </span><span style="color: #098658">10</span><span style="color: #000000">)</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">person</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Person</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Bob&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;Morane&#039;</span><span style="color: #000000">, </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;1998-10-21&#039;</span><span style="color: #000000">));</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">person</span><span style="color: #000000">);</span>
<span style="color: #008000">// {   &quot;name&quot;: [&quot;Bob&quot;, &quot;Morane&quot;],</span>
<span style="color: #008000">//     &quot;birthDate&quot;: &quot;1998-10-21&quot;</span>
<span style="color: #008000">// }</span>
</code></pre>
				<a href="#types-ambivalence" id="types-ambivalence" style="color: inherit; text-decoration: none;">
					<h3>Types ambivalence</h3>
				</a>
				<p>If you examine the <code>Person</code> class <strong>below</strong>, you will see that the <code>birthDate</code> field is a <code>Date</code> instance. Its builder is a function that takes as argument the object with the fields that is supplied by <code>JSON.parse()</code> <strong>after</strong> each field has been augmented : unlike the previous example, the <code>birthDate</code> is augmented to a <code>Date</code> <strong>before</strong> passing it to the builder. This also works as long as the source type is the same as the target type : the builder can create a new instance of <code>Person</code> because the source types have been augmented. But in fact, the source <strong>IS NOT</strong> the strict description of the JSON structure : the <code>birthDate</code> is typed as a <code>Date</code> but it is a string.</p>
				<blockquote>
					<p>Jsonizer chooses to reflect the types that fit better to a DTO, rather than those that appear in the JSON structure (only objects, arrays, strings, numbers, booleans, and nulls), because finally, JSON is just a text representation. The motivation for this choice is that the more often, the source and target structure are described by the same type, and it&#39;s very natural to have the right types when creating new instances.</p>
				</blockquote>
				<p>Thus, alternatively to the previous example, we may assume that the existing <code>Date</code> type is suitable for a &quot;<code>DateDTO</code>&quot; :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">type</span><span style="color: #000000"> </span><span style="color: #267F99">PersonDTO</span><span style="color: #000000"> = {</span>
<span style="color: #000000">    </span><span style="color: #001080">name</span><span style="color: #000000">: [</span><span style="color: #267F99">string</span><span style="color: #000000">, </span><span style="color: #267F99">string</span><span style="color: #000000">]</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000"> </span><span style="color: #008000">// üëà  revived in the builder</span>
<span style="color: #000000">}</span>

<span style="color: #008000">//       Target   Source</span>
<span style="color: #008000">//         üëá        üëá                  a Date instance, because we have a mapper</span>
<span style="color: #000000">@</span><span style="color: #267F99">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">, </span><span style="color: #267F99">PersonDTO</span><span style="color: #000000">&gt;({ </span><span style="color: #008000">//            üëá</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #000000">: ({</span><span style="color: #001080">name</span><span style="color: #000000">: [</span><span style="color: #267F99">firstName</span><span style="color: #000000">, </span><span style="color: #267F99">lastName</span><span style="color: #000000">], </span><span style="color: #001080">birthDate</span><span style="color: #000000">}) </span><span style="color: #0000FF">=&gt;</span>
<span style="color: #000000">        </span><span style="color: #267F99">new</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000">(</span><span style="color: #001080">firstName</span><span style="color: #000000">, </span><span style="color: #001080">lastName</span><span style="color: #000000">, </span><span style="color: #001080">birthDate</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000">                  </span><span style="color: #008000">//     üëÜ</span>
<span style="color: #000000">})                                   </span><span style="color: #008000">// ‚úÖ Date instance expected</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">firstName</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">lastName</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">    ) {}</span>
<span style="color: #000000">    </span><span style="color: #795E26">toJSON</span><span style="color: #000000">(): </span><span style="color: #267F99">PersonDTO</span><span style="color: #000000"> { </span><span style="color: #008000">// üëà  if we force the result to be a PersonDTO...</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #001080">name:</span><span style="color: #000000"> [</span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">firstName</span><span style="color: #000000">, </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">lastName</span><span style="color: #000000">],</span>
<span style="color: #000000">            </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">birthDate</span>
<span style="color: #000000">                .</span><span style="color: #795E26">toISOString</span><span style="color: #000000">().</span><span style="color: #795E26">slice</span><span style="color: #000000">(</span><span style="color: #098658">0</span><span style="color: #000000">, </span><span style="color: #098658">10</span><span style="color: #000000">) </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">any</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">        }                                   </span><span style="color: #008000">// üëÜ    ‚ùå ...we get a type mismatch</span>
<span style="color: #000000">    }                                       </span><span style="color: #008000">// consequence of ambivalence</span>
<span style="color: #000000">}                                           </span><span style="color: #008000">// but it&#039;s fine to use it too !</span>
</code></pre>
				<blockquote>
					<p>Be aware that there is a little difference between the DTO structure and the pure JSON structure that will be converted to a JSON string ; that difference also applies to classes: DTOs still brings the information of the types (<code>Date</code>, <code>Person</code>, <code>Hobby</code>, etc) according to Typescript whereas they are pure javascript structures (made of objects, arrays, strings, numbers, booleans and nulls). Above, the <code>birthDate</code> field described in the <code>PersonDTO</code> type is a <code>Date</code>, but the date is serialized to a string ; however, since there is a mapper that transform that string to a <code>Date</code>, it can be passed as a <code>Date</code> argument to the constructor. DTOs are more a sort of &#39;in-between&#39; description of fields that are really represented in JSON at the very end, but marked as typed data during parsing.</p>
				</blockquote>
				<a href="#mappers-for-sub-dto" id="mappers-for-sub-dto" style="color: inherit; text-decoration: none;">
					<h3>Mappers for Sub-DTO</h3>
				</a>
				<p>The mappers are described by a plain object of the type <code>Mappers&lt;Target, Source&gt;</code>. When using <code>@Reviver&lt;Target, Source&gt;()</code> or <code>Jsonizer.reviver&lt;Target, Source&gt;()</code>, in fact you pass a recursive mappers structure.</p>
				<p>At the top level, it is easy to specify the target and the source as shown before, but within nested structure, Jsonizer doesn&#39;t have enough informations to expose the right mappers fields. In that case, it is possible to enforce the types by explicitely set the submappers&#39;s type (this is not so different than using &quot;pass-through&quot; utility classes) :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">interface</span><span style="color: #000000"> </span><span style="color: #267F99">Hobby</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">hobby</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">startDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">}</span>
<span style="color: #0000FF">type</span><span style="color: #000000"> </span><span style="color: #267F99">HobbyDTO</span><span style="color: #000000"> = [</span><span style="color: #267F99">string</span><span style="color: #000000">, </span><span style="color: #267F99">Date</span><span style="color: #000000">];</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">hobbiesMapper</span><span style="color: #000000">: </span><span style="color: #267F99">Mappers</span><span style="color: #000000">&lt;</span><span style="color: #267F99">HobbyDTO</span><span style="color: #000000">[]&gt; = { </span><span style="color: #008000">// üëà  Source = Target</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;*&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #098658">1</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>

<span style="color: #0000FF">type</span><span style="color: #000000"> </span><span style="color: #267F99">PersonDTO</span><span style="color: #000000"> = {</span>
<span style="color: #000000">    </span><span style="color: #001080">name</span><span style="color: #000000">: [</span><span style="color: #267F99">string</span><span style="color: #000000">, </span><span style="color: #267F99">string</span><span style="color: #000000">]</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">    </span><span style="color: #001080">hobbies</span><span style="color: #000000">: </span><span style="color: #267F99">HobbyDTO</span><span style="color: #000000">[]</span>
<span style="color: #000000">}</span>

<span style="color: #008000">//       Target   Source</span>
<span style="color: #008000">//         üëá        üëá</span>
<span style="color: #000000">@</span><span style="color: #267F99">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">, </span><span style="color: #267F99">PersonDTO</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #000000">: ({</span><span style="color: #001080">name</span><span style="color: #000000">: [</span><span style="color: #267F99">firstName</span><span style="color: #000000">, </span><span style="color: #267F99">lastName</span><span style="color: #000000">], </span><span style="color: #001080">birthDate</span><span style="color: #000000">, </span><span style="color: #001080">hobbies</span><span style="color: #000000">}) </span><span style="color: #0000FF">=&gt;</span>
<span style="color: #000000">        </span><span style="color: #267F99">new</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000">(</span><span style="color: #001080">firstName</span><span style="color: #000000">, </span><span style="color: #001080">lastName</span><span style="color: #000000">, </span><span style="color: #001080">birthDate</span><span style="color: #000000">,</span>
<span style="color: #000000">            </span><span style="color: #008000">// map the HobbyDTO tuple to Hobby object</span>
<span style="color: #000000">            hobbies.map(([</span><span style="color: #001080">hobby</span><span style="color: #000000">, </span><span style="color: #001080">startDate</span><span style="color: #000000">]) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> ({ </span><span style="color: #001080">hobby</span><span style="color: #000000">, </span><span style="color: #001080">startDate</span><span style="color: #000000"> }))),</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">hobbies</span><span style="color: #000000">: </span><span style="color: #267F99">hobbiesMapper</span>
<span style="color: #000000">})</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">firstName</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">lastName</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">hobbies</span><span style="color: #000000">: </span><span style="color: #267F99">Hobby</span><span style="color: #000000">[]</span>
<span style="color: #000000">    ) {}</span>
<span style="color: #000000">    </span><span style="color: #795E26">toJSON</span><span style="color: #000000">(): </span><span style="color: #267F99">PersonDTO</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #001080">name:</span><span style="color: #000000"> [</span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">firstName</span><span style="color: #000000">, </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">lastName</span><span style="color: #000000">],</span>
<span style="color: #000000">            </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">birthDate</span>
<span style="color: #000000">                .</span><span style="color: #795E26">toISOString</span><span style="color: #000000">().</span><span style="color: #795E26">slice</span><span style="color: #000000">(</span><span style="color: #098658">0</span><span style="color: #000000">, </span><span style="color: #098658">10</span><span style="color: #000000">) </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">any</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">            </span><span style="color: #008000">// map each Hobby objects to a HobbyDTO tuple</span>
<span style="color: #000000">            </span><span style="color: #001080">hobbies:</span><span style="color: #000000"> </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">hobbies</span><span style="color: #000000">.</span><span style="color: #795E26">map</span><span style="color: #000000">(({ </span><span style="color: #001080">hobby</span><span style="color: #000000">, </span><span style="color: #001080">startDate</span><span style="color: #000000"> }) </span><span style="color: #0000FF">=&gt;</span>
<span style="color: #000000">                [</span><span style="color: #001080">hobby</span><span style="color: #000000">, </span><span style="color: #001080">startDate</span><span style="color: #000000">.</span><span style="color: #795E26">toISOString</span><span style="color: #000000">().</span><span style="color: #795E26">slice</span><span style="color: #000000">(</span><span style="color: #098658">0</span><span style="color: #000000">, </span><span style="color: #098658">10</span><span style="color: #000000">) </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">any</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">])</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>Alternatively, instead of mapping <code>HobbyDTO</code> to <code>Hobby</code> in the person&#39;s builder, we can create a <code>Hobby</code> builder, and cast it accordingly in the person&#39;s builder.</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">hobbiesMapper</span><span style="color: #000000">: </span><span style="color: #267F99">Mappers</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Hobby</span><span style="color: #000000">[], </span><span style="color: #267F99">HobbyDTO</span><span style="color: #000000">[]&gt; = { </span><span style="color: #008000">// üëà  Source ‚â† Target</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;*&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> ([</span><span style="color: #001080">hobby</span><span style="color: #000000">, </span><span style="color: #001080">startDate</span><span style="color: #000000">]) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> ({ </span><span style="color: #001080">hobby</span><span style="color: #000000">, </span><span style="color: #001080">startDate</span><span style="color: #000000"> }), </span><span style="color: #008000">// üëà  change the shape</span>
<span style="color: #000000">        </span><span style="color: #098658">1</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>

<span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">, </span><span style="color: #267F99">PersonDTO</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> ({</span><span style="color: #001080">name</span><span style="color: #000000">: [</span><span style="color: #001080">firstName</span><span style="color: #000000">, </span><span style="color: #001080">lastName</span><span style="color: #000000">], </span><span style="color: #001080">birthDate</span><span style="color: #000000">, </span><span style="color: #001080">hobbies</span><span style="color: #000000">}) </span><span style="color: #0000FF">=&gt;</span>
<span style="color: #000000">        </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Person</span><span style="color: #000000">(</span><span style="color: #001080">firstName</span><span style="color: #000000">, </span><span style="color: #001080">lastName</span><span style="color: #000000">, </span><span style="color: #001080">birthDate</span><span style="color: #000000">,</span>
<span style="color: #000000">            </span><span style="color: #001080">hobbies</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">any</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">Hobby</span><span style="color: #000000">[]), </span><span style="color: #008000">// üëà  change the type accordingly</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">hobbies:</span><span style="color: #000000"> </span><span style="color: #001080">hobbiesMapper</span>
<span style="color: #000000">})</span>
</code></pre>
				<a href="#reviving-third-party-classes-and-built-in-classes" id="reviving-third-party-classes-and-built-in-classes" style="color: inherit; text-decoration: none;">
					<h3>Reviving third-party classes and built-in classes</h3>
				</a>
				<p>Just use <code>Reviver</code> as a normal function :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">type</span><span style="color: #000000"> </span><span style="color: #267F99">BufferDTO</span><span style="color: #000000"> = </span><span style="color: #267F99">ReturnType</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">typeof</span><span style="color: #000000"> </span><span style="color: #267F99">Buffer</span><span style="color: #000000">.</span><span style="color: #001080">prototype</span><span style="color: #000000">.</span><span style="color: #001080">toJSON</span><span style="color: #000000">&gt;</span>

<span style="color: #267F99">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Buffer</span><span style="color: #000000">, </span><span style="color: #267F99">BufferDTO</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #000000">: ({</span><span style="color: #001080">data</span><span style="color: #000000">}) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #267F99">Buffer</span><span style="color: #000000">.</span><span style="color: #267F99">from</span><span style="color: #000000">(</span><span style="color: #267F99">data</span><span style="color: #000000">)</span>
<span style="color: #000000">})(</span><span style="color: #267F99">Buffer</span><span style="color: #000000">); </span><span style="color: #008000">// üëà  apply it to built-in or third-party classes</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">buf</span><span style="color: #000000"> = </span><span style="color: #001080">Buffer</span><span style="color: #000000">.</span><span style="color: #795E26">from</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;ceci est un test&#039;</span><span style="color: #000000">);</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">bufJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">buf</span><span style="color: #000000">);</span>
<span style="color: #008000">// {   &quot;type&quot;:&quot;Buffer&quot;,</span>
<span style="color: #008000">//     &quot;data&quot;:[99,101,99,105,32,101,115,116,32,117,110,32,116,101,115,116]</span>
<span style="color: #008000">// }</span>
</code></pre>
				<p>Revive it as usual :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">bufFromJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">bufJson</span><span style="color: #000000">, </span><span style="color: #001080">Reviver</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #001080">Buffer</span><span style="color: #000000">));</span>
</code></pre>
				<a href="#jsonizertojson" id="jsonizertojson" style="color: inherit; text-decoration: none;">
					<h3><code>[Jsonizer.toJSON]</code></h3>
				</a>
				<p>In certain circumstances you want to left as-is the original <code>toJSON()</code> method of an existing class, so that existing code won&#39;t break. However, if you still want a customize serialization when using <code>JSON.stringify()</code>, you may instead define the method <code>[Jsonizer.toJSON]()</code> :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">declare</span><span style="color: #000000"> </span><span style="color: #001080">global</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">interface</span><span style="color: #000000"> </span><span style="color: #267F99">Buffer</span><span style="color: #000000"> {</span>
<span style="color: #000000">        [</span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #001080">toJSON</span><span style="color: #000000">](): </span><span style="color: #267F99">any</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
<span style="color: #267F99">Buffer</span><span style="color: #000000">.</span><span style="color: #001080">prototype</span><span style="color: #000000">[</span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #001080">toJSON</span><span style="color: #000000">] = </span><span style="color: #0000FF">function</span><span style="color: #000000">() { </span><span style="color: #008000">// üëà  plug our custom function</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> [...</span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #795E26">values</span><span style="color: #000000">()]</span>
<span style="color: #000000">}</span>

<span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Buffer</span><span style="color: #000000">, </span><span style="color: #267F99">number</span><span style="color: #000000">[]&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">values</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">Buffer</span><span style="color: #000000">.</span><span style="color: #795E26">from</span><span style="color: #000000">(</span><span style="color: #001080">values</span><span style="color: #000000">)</span>
<span style="color: #000000">})(</span><span style="color: #001080">Buffer</span><span style="color: #000000">);</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">buf</span><span style="color: #000000"> = </span><span style="color: #001080">Buffer</span><span style="color: #000000">.</span><span style="color: #795E26">from</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;ceci est un test&#039;</span><span style="color: #000000">);</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">bufJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">buf</span><span style="color: #000000">);</span>
<span style="color: #008000">// [99,101,99,105,32,101,115,116,32,117,110,32,116,101,115,116]</span>
</code></pre>
				<a href="#ranges-and-regexp" id="ranges-and-regexp" style="color: inherit; text-decoration: none;">
					<h2>Ranges and Regexp</h2>
				</a>
				<p>So far, the mappers object of a <strong>target object</strong> could contain entries that are either the field names of the target object or <code>&#39;*&#39;</code> plus the special <code>&#39;.&#39;</code> entry for the builder. There is another possibility, using a string representation of a regular expression in order to match some fields name, e.g. <code>&#39;/\\w+Date/&#39;</code> to match fields name that ends with &#39;Date&#39;.</p>
				<p>Similarly, the mappers object of a <strong>target array</strong> could be extended to a range of indexes, e.g. <code>&#39;8-12&#39;</code> to match indexes between 8 and 12 (included).</p>
				<blockquote>
					<p>Since the mappers object entries are enforced by Typescript (and because we wouldn&#39;t like to open the entries to any string), we have to extend explicitely the new entries to allow by repeating it in the 3rd parameter type of the mapper : <code>Mapper&lt;Target, Source, Match&gt;</code>.</p>
				</blockquote>
				<a href="#regexp" id="regexp" style="color: inherit; text-decoration: none;">
					<h3>Regexp</h3>
				</a>
				<blockquote>
					<p>RegExp keys are represented as strings, which may introduce additional escapes, e.g. <code>/\w+Date/.toString()</code> gives <code>&#39;/\\w+Date/&#39;</code></p>
				</blockquote>
				<pre><code class="language-typescript"><span style="color: #008000">//       Target Source   RegExp[]</span>
<span style="color: #008000">//         üëá     üëá        üëá</span>
<span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Hobby</span><span style="color: #000000">, </span><span style="color: #267F99">Hobby</span><span style="color: #000000">, [</span><span style="color: #A31515">&#039;/</span><span style="color: #EE0000">\\</span><span style="color: #A31515">w+Date/&#039;</span><span style="color: #000000">]&gt;({ </span><span style="color: #008000">// üëà  extend allowed entries in the 3rd type parameter</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #001080">Self</span><span style="color: #000000">.</span><span style="color: #795E26">apply</span><span style="color: #000000">(</span><span style="color: #001080">Hobby</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;/</span><span style="color: #EE0000">\\</span><span style="color: #A31515">w+Date/&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000"> </span><span style="color: #008000">// üëà matches any field that ends with &#039;Date&#039;</span>
<span style="color: #000000">})</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Hobby</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">hobby</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">startDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">endDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">lastDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">    ) {}</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>Note that a similar result could be achieved with the following mappings:</p>
				<pre><code class="language-typescript"><span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Hobby</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #001080">Self</span><span style="color: #000000">.</span><span style="color: #795E26">apply</span><span style="color: #000000">(</span><span style="color: #001080">Hobby</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;*&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000"> </span><span style="color: #008000">// üëà matches any field...</span>
<span style="color: #000000">    </span><span style="color: #001080">hobby</span><span style="color: #000000">: </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #001080">Self</span><span style="color: #000000">.</span><span style="color: #001080">Identity</span><span style="color: #000000"> </span><span style="color: #008000">// üëà  ...except &#039;hobby&#039;, kept unchanged</span>
<span style="color: #000000">})</span>
</code></pre>
				<p>A mapper applies the following priority to a property name or an index:</p>
				<ol>
					<li>exact name match,</li>
					<li>RegExp match or range match (see after),</li>
					<li>any match (<code>&#39;*&#39;</code>) if present</li>
				</ol>
				<p>otherwise, there is no mapping : the value is kept as-is.</p>
				<a href="#ranges" id="ranges" style="color: inherit; text-decoration: none;">
					<h3>Ranges</h3>
				</a>
				<pre><code class="language-typescript"><span style="color: #008000">//     üëá  the JSON structure is a tuple</span>
<span style="color: #0000FF">type</span><span style="color: #000000"> </span><span style="color: #267F99">CarDTO</span><span style="color: #000000"> = [</span><span style="color: #267F99">Wheel</span><span style="color: #000000">, </span><span style="color: #267F99">Wheel</span><span style="color: #000000">, </span><span style="color: #267F99">Wheel</span><span style="color: #000000">, </span><span style="color: #267F99">Wheel</span><span style="color: #000000">, </span><span style="color: #267F99">Engine</span><span style="color: #000000">];</span>

<span style="color: #008000">//     Target Source  range[]</span>
<span style="color: #008000">//       üëá     üëá       üëá</span>
<span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Car</span><span style="color: #000000">, </span><span style="color: #267F99">CarDTO</span><span style="color: #000000">, [</span><span style="color: #A31515">&#039;0-3&#039;</span><span style="color: #000000">]&gt;({ </span><span style="color: #008000">// üëà  extend allowed entries in the 3rd type parameter</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> ([</span><span style="color: #001080">w1</span><span style="color: #000000">, </span><span style="color: #001080">w2</span><span style="color: #000000">, </span><span style="color: #001080">w3</span><span style="color: #000000">, </span><span style="color: #001080">w4</span><span style="color: #000000">, </span><span style="color: #001080">e</span><span style="color: #000000">]) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Car</span><span style="color: #000000">(</span><span style="color: #001080">e</span><span style="color: #000000">, </span><span style="color: #001080">w1</span><span style="color: #000000">, </span><span style="color: #001080">w2</span><span style="color: #000000">, </span><span style="color: #001080">w3</span><span style="color: #000000">, </span><span style="color: #001080">w4</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;0-3&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">Wheel</span><span style="color: #000000">, </span><span style="color: #008000">// üëà matches the four first items</span>
<span style="color: #000000">    </span><span style="color: #098658">4</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">Engine</span><span style="color: #000000"> </span><span style="color: #008000">// üëà  we could use &#039;*&#039; for the rest</span>
<span style="color: #000000">})</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Car</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">wheels</span><span style="color: #000000">: </span><span style="color: #267F99">Wheel</span><span style="color: #000000">[];</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">engine</span><span style="color: #000000">: </span><span style="color: #267F99">Engine</span><span style="color: #000000">,</span>
<span style="color: #000000">        ...</span><span style="color: #001080">wheels</span><span style="color: #000000">: </span><span style="color: #267F99">Wheel</span><span style="color: #000000">[]</span>
<span style="color: #000000">    ) {</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">wheels</span><span style="color: #000000">.</span><span style="color: #001080">length</span><span style="color: #000000"> !== </span><span style="color: #098658">4</span><span style="color: #000000">) {</span>
<span style="color: #000000">            </span><span style="color: #AF00DB">throw</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Error</span><span style="color: #000000">(</span><span style="color: #A31515">`A car must have 4 wheels ; found </span><span style="color: #0000FF">${</span><span style="color: #001080">wheels</span><span style="color: #000000FF">.</span><span style="color: #001080">length</span><span style="color: #0000FF">}</span><span style="color: #A31515">`</span><span style="color: #000000">);</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">        </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">wheels</span><span style="color: #000000"> = </span><span style="color: #001080">wheels</span><span style="color: #000000">;</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">    </span><span style="color: #795E26">toJSON</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> [...</span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">wheels</span><span style="color: #000000">, </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">engine</span><span style="color: #000000">]; </span><span style="color: #008000">// üëà  jsonify as an array</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#namespaces" id="namespaces" style="color: inherit; text-decoration: none;">
					<h2>Namespaces</h2>
				</a>
				<p>Classes have their own identity. Several classes may have the same name in certain circumstances :</p>
				<ul>
					<li>when their scope don&#39;t overlap (shadowing)</li>
					<li>when they are imported under a different name (which doesn&#39;t affect their internal name)</li>
				</ul>
				<p>In both cases, the proper name of a class is not enough to distinguish classes in a higher scope, where Jsonizer works. This is where namespaces can help.</p>
				<blockquote>
					<p>Javascript and Typescript can group items together under namespaces, which lead roughly to a hierarchy of objects, but the items themselves when they are classes don&#39;t have the knowledge of the hierarchy they belong to. The purpose of Jsonizer&#39;s namespaces is to let classes knowing their fully qualified name.</p>
				</blockquote>
				<p>A namespace aims to group related items under a universal naming system (for names that are supposed to be shared, typically when writing a library), or to a local name (for names that are not supposed to be reused, typically within an application).</p>
				<a href="#choosing-a-namespace" id="choosing-a-namespace" style="color: inherit; text-decoration: none;">
					<h3>Choosing a namespace</h3>
				</a>
				<ul>
					<li><p>We suggest to left in the default namespace <code>&#39;&#39;</code> (no namespace) the built-in classes of the Javascript language. This means that if you want to name a class that already has such name, or if you want to use a class of a third-party library that already has such name, that classes have to be set in a namespace.</p>
					</li>
					<li><p>For a library of your own, it is strongly recommended to use a universal naming system. We suggest to use the reverse DNS name of your company / organization as the base name, e.g. <code>com.example.myLib</code>, or even the repo where it is published, e.g. <code>com.github.myLib</code>, or the name under which you published it in npm, e.g. <code>@example/myLib</code>, or <code>npm:myLib</code>.</p>
					</li>
					<li><p>For an app of your own, since nothing is designed to be exposed to others, a relative name such as <code>myApp</code> is enough.</p>
					</li>
					<li><p>Jsonizer&#39;s own namespace is <code>@badcafe/jsonizer</code> and <strong>must not</strong> be used for other material than those available in this library.</p>
					</li>
				</ul>
				<a href="#jsonizer-namespaces" id="jsonizer-namespaces" style="color: inherit; text-decoration: none;">
					<h3>Jsonizer namespaces</h3>
				</a>
				<p>A namespace is mandatory for example to refer 2 classes with the same name, e.g. <code>Category</code> (of a product) and <code>Category</code> (of a movie). To be precise, a class decorated with <code>@Reviver</code> should be decorated with <code>@Namespace</code> (in any order), although Jsonizer namespaces might be also useful outside of the context of Jsonizer.</p>
				<p>A namespace has to be unique within an application, therefore classes that are designed to be exposed in a library should be decorated with a universal unique namespace, e.g. <code>org.example.myLib</code>. Conversely, it is enough for a standalone application to group subordinate classes together using relative namespaces.</p>
				<ul>
					<li><p>using a universal unique namespace identifier :</p>
						<pre><code class="language-typescript"><span style="color: #000000">@</span><span style="color: #795E26">Namespace</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;org.example.myLib&#039;</span><span style="color: #000000">)</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Foo</span><span style="color: #000000"> {}</span>
<span style="color: #000000"> </span><span style="color: #008000">// üëÜ qualified name set to &#039;org.example.myLib.Foo&#039;</span>
</code></pre>
					</li>
					<li><p>using relative namespaces :</p>
						<pre><code class="language-typescript"><span style="color: #000000">@</span><span style="color: #795E26">Namespace</span><span style="color: #000000">(</span><span style="color: #001080">Product</span><span style="color: #000000">)</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Category</span><span style="color: #000000"> {}</span>
<span style="color: #000000"> </span><span style="color: #008000">// üëÜ qualified name set to &#039;Product.Category&#039;</span>
<span style="color: #008000">// and in a separate file :</span>
<span style="color: #000000">@</span><span style="color: #795E26">Namespace</span><span style="color: #000000">(</span><span style="color: #001080">Movie</span><span style="color: #000000">)</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Category</span><span style="color: #000000"> {}</span>
<span style="color: #000000">  </span><span style="color: #008000">// üëÜ qualified name set to &#039;Movie.Category&#039;</span>
</code></pre>
					</li>
				</ul>
				<p>In the example above, even if an app imports 2 classes with the same name <code>Product</code>, it is still possible to relocate one (or both) of them :</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">Product</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #001080">Product1</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;./myApp&#039;</span><span style="color: #000000">;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">Product</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #001080">Product2</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;someLib&#039;</span><span style="color: #000000">;</span>

<span style="color: #795E26">Namespace</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;org.example.myApp&#039;</span><span style="color: #000000">)(</span><span style="color: #001080">Product1</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #008000">// qualified name               üëÜ</span>
<span style="color: #000000">    </span><span style="color: #008000">// set to &#039;org.example.myApp.Product&#039; </span>

<span style="color: #795E26">Namespace</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;com.example.products&#039;</span><span style="color: #000000">)(</span><span style="color: #001080">Product2</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #008000">// qualified name                  üëÜ</span>
<span style="color: #000000">    </span><span style="color: #008000">// set to &#039;com.example.products.Product&#039; </span>
</code></pre>
				<p>By transitivity, the Category is relocated to <code>org.example.myApp.Product.Category</code></p>
				<a href="#when-jsonizer-is-using-namespace-" id="when-jsonizer-is-using-namespace-" style="color: inherit; text-decoration: none;">
					<h4>When Jsonizer is using namespace ?</h4>
				</a>
				<p>The more often, you don&#39;t have to take care of namespaces, but if you expose your classes in a library, this is your responsability. Don&#39;t let the users of your library set themselves a namespace to your classes.</p>
				<p>Jsonizer use namespaces when revivers are sent aside the data to revive. A stringified reviver lost the class identity to which it belongs, that can be recover only thanks to namespaces. Jsonizer will warn you when 2 revivers are bound to classes with the same qualified name.</p>
				<blockquote>
					<p>Don&#39;t write mappers with qualified names, e.g.</p>
					<pre><code class="language-typescript"><span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Category</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #001080">category:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;org.example.myApp.Product.Category&#039;</span><span style="color: #000000"> </span><span style="color: #008000">// üëé  don&#039;t write that</span>
<span style="color: #000000">}</span>
</code></pre>
					<p>if the class is relocated, that mapping will not be found ; instead, write mappers with class references, e.g.</p>
					<pre><code class="language-typescript"><span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Category</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #001080">category:</span><span style="color: #000000"> </span><span style="color: #001080">Category</span><span style="color: #000000"> </span><span style="color: #008000">// üëç referred regardless of its namespace</span>
<span style="color: #000000">}</span>
</code></pre>
					<p>The qualified names will be used by Jsonizer only when serializing revivers at the latest stage.</p>
				</blockquote>
				<a href="#summary" id="summary" style="color: inherit; text-decoration: none;">
					<h4>Summary</h4>
				</a>
				<p>Usage as a decorator :</p>
				<pre><code class="language-typescript"><span style="color: #000000">@</span><span style="color: #795E26">Namespace</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;org.example.myApp&#039;</span><span style="color: #000000">)</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Foo</span><span style="color: #000000"> {}</span>
<span style="color: #000000">    </span><span style="color: #008000">// üëÜ qualified name set to &#039;org.example.myApp.Foo&#039;</span>

<span style="color: #008000">// setting a relative namespace :</span>
<span style="color: #000000">@</span><span style="color: #795E26">Namespace</span><span style="color: #000000">(</span><span style="color: #001080">Foo</span><span style="color: #000000">)</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Bar</span><span style="color: #000000"> {}</span>
<span style="color: #000000">    </span><span style="color: #008000">// üëÜ qualified name set to &#039;org.example.myApp.Foo.Bar&#039;</span>

<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Baz</span><span style="color: #000000"> {}</span>

<span style="color: #000000">@</span><span style="color: #795E26">Namespace</span><span style="color: #000000">(</span><span style="color: #001080">Baz</span><span style="color: #000000">)</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Qux</span><span style="color: #000000"> {}</span>
<span style="color: #000000">    </span><span style="color: #008000">// üëÜ qualified name set to &#039;Baz.Qux&#039;</span>
</code></pre>
				<p>Usage as a function :</p>
				<pre><code class="language-typescript"><span style="color: #008000">// setting a namespace to an existing class :</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">Quux</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;quuxLib&#039;</span><span style="color: #000000">;</span>
<span style="color: #795E26">Namespace</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;org.example.myApp&#039;</span><span style="color: #000000">)(</span><span style="color: #001080">Quux</span><span style="color: #000000">)</span>
<span style="color: #000000">                             </span><span style="color: #008000">// üëÜ qualified name set to</span>
<span style="color: #000000">                             </span><span style="color: #008000">// &#039;org.example.myApp.Quux&#039;</span>

<span style="color: #008000">// relocating a class</span>
<span style="color: #795E26">Namespace</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;org.example.myApp&#039;</span><span style="color: #000000">)(</span><span style="color: #001080">Baz</span><span style="color: #000000">)</span>
<span style="color: #000000">                             </span><span style="color: #008000">// üëÜ qualified name set to</span>
<span style="color: #000000">                             </span><span style="color: #008000">// &#039;org.example.myApp.Baz&#039;</span>
<span style="color: #008000">// and incidentally, Qux subordinate qualified name</span>
<span style="color: #008000">//                       set to &#039;org.example.myApp.Baz.Qux&#039;</span>
</code></pre>
				<a href="#typescript-namespaces" id="typescript-namespaces" style="color: inherit; text-decoration: none;">
					<h3>Typescript namespaces</h3>
				</a>
				<p>Although Jsonizer&#39;s namespaces are unrelated to Typescript&#39;s namespaces, it is a good practice to organize your library or your app by grouping subordinate materials under a namespace, and apply Jsonizer&#39;s namespace as a layer above.</p>
				<p>To recall the previous examples, we consider that a person&#39;s hobby is a concept strongly related to, well, a person, therefore we prefer naming it <code>Person.Hobby</code>. Other direct subordinate materials are also chained : <code>Person.DTO</code>, <code>Person.Hobby.DTO</code> and <code>Person.Hobby.mapper</code>.</p>
				<pre><code class="language-typescript"><span style="color: #000000">@</span><span style="color: #795E26">Namespace</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;org.example.peopleHobbies&#039;</span><span style="color: #000000">) </span><span style="color: #008000">// üëà  absolute namespace</span>
<span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">, </span><span style="color: #267F99">Person</span><span style="color: #000000">.</span><span style="color: #267F99">DTO</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> ({</span><span style="color: #001080">name</span><span style="color: #000000">: [</span><span style="color: #001080">firstName</span><span style="color: #000000">, </span><span style="color: #001080">lastName</span><span style="color: #000000">], </span><span style="color: #001080">birthDate</span><span style="color: #000000">, </span><span style="color: #001080">hobbies</span><span style="color: #000000">}) </span><span style="color: #0000FF">=&gt;</span>
<span style="color: #000000">        </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Person</span><span style="color: #000000">(</span><span style="color: #001080">firstName</span><span style="color: #000000">, </span><span style="color: #001080">lastName</span><span style="color: #000000">, </span><span style="color: #001080">birthDate</span><span style="color: #000000">,</span>
<span style="color: #000000">            </span><span style="color: #001080">hobbies</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">any</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000">.</span><span style="color: #267F99">Hobby</span><span style="color: #000000">[]),</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">hobbies:</span><span style="color: #000000"> </span><span style="color: #001080">Person</span><span style="color: #000000">.</span><span style="color: #001080">Hobby</span><span style="color: #000000">.</span><span style="color: #001080">mapper</span>
<span style="color: #000000">})</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> { </span><span style="color: #008000">// üëà &quot;org.example.peopleHobbies.Person&quot;</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">firstName</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">lastName</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">hobbies</span><span style="color: #000000">: </span><span style="color: #267F99">Person</span><span style="color: #000000">.</span><span style="color: #267F99">Hobby</span><span style="color: #000000">[]</span>
<span style="color: #000000">    ) {}</span>
<span style="color: #000000">    </span><span style="color: #795E26">toJSON</span><span style="color: #000000">(): </span><span style="color: #267F99">Person</span><span style="color: #000000">.</span><span style="color: #267F99">DTO</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #001080">name:</span><span style="color: #000000"> [</span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">firstName</span><span style="color: #000000">, </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">lastName</span><span style="color: #000000">],</span>
<span style="color: #000000">            </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">birthDate</span><span style="color: #000000">.</span><span style="color: #795E26">toISOString</span><span style="color: #000000">().</span><span style="color: #795E26">slice</span><span style="color: #000000">(</span><span style="color: #098658">0</span><span style="color: #000000">, </span><span style="color: #098658">10</span><span style="color: #000000">) </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">any</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">            </span><span style="color: #001080">hobbies:</span><span style="color: #000000"> </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">hobbies</span><span style="color: #000000">.</span><span style="color: #795E26">map</span><span style="color: #000000">(({ </span><span style="color: #001080">hobby</span><span style="color: #000000">, </span><span style="color: #001080">startDate</span><span style="color: #000000"> }) </span><span style="color: #0000FF">=&gt;</span>
<span style="color: #000000">                [</span><span style="color: #001080">hobby</span><span style="color: #000000">, </span><span style="color: #001080">startDate</span><span style="color: #000000">.</span><span style="color: #795E26">toISOString</span><span style="color: #000000">().</span><span style="color: #795E26">slice</span><span style="color: #000000">(</span><span style="color: #098658">0</span><span style="color: #000000">, </span><span style="color: #098658">10</span><span style="color: #000000">) </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">any</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">])</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">namespace</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">type</span><span style="color: #000000"> </span><span style="color: #267F99">DTO</span><span style="color: #000000"> = {</span>
<span style="color: #000000">        </span><span style="color: #001080">name</span><span style="color: #000000">: [</span><span style="color: #267F99">string</span><span style="color: #000000">, </span><span style="color: #267F99">string</span><span style="color: #000000">]</span>
<span style="color: #000000">        </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">        </span><span style="color: #001080">hobbies</span><span style="color: #000000">: </span><span style="color: #267F99">Hobby</span><span style="color: #000000">.</span><span style="color: #267F99">DTO</span><span style="color: #000000">[]</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">interface</span><span style="color: #000000"> </span><span style="color: #267F99">Hobby</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #001080">hobby</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">startDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">namespace</span><span style="color: #000000"> </span><span style="color: #267F99">Hobby</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">type</span><span style="color: #000000"> </span><span style="color: #267F99">DTO</span><span style="color: #000000"> = [</span><span style="color: #267F99">string</span><span style="color: #000000">, </span><span style="color: #267F99">Date</span><span style="color: #000000">];</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">mapper</span><span style="color: #000000">: </span><span style="color: #267F99">Mappers</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Hobby</span><span style="color: #000000">[], </span><span style="color: #267F99">Hobby</span><span style="color: #000000">.</span><span style="color: #267F99">DTO</span><span style="color: #000000">[]&gt; = {</span>
<span style="color: #000000">            </span><span style="color: #A31515">&#039;*&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> {</span>
<span style="color: #000000">                </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> ([</span><span style="color: #001080">hobby</span><span style="color: #000000">, </span><span style="color: #001080">startDate</span><span style="color: #000000">]) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> ({ </span><span style="color: #001080">hobby</span><span style="color: #000000">, </span><span style="color: #001080">startDate</span><span style="color: #000000"> }),</span>
<span style="color: #000000">                </span><span style="color: #098658">1</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">            }</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>Using classes may lead to some chicken üêî and egg ü•ö issue that can be resolved easily with an <a href="https://developer.mozilla.org/en-US/docs/Glossary/IIFE">IIFE</a> :</p>
				<pre><code class="language-typescript"><span style="color: #000000">@</span><span style="color: #795E26">Namespace</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;org.example.peopleHobbies&#039;</span><span style="color: #000000">) </span><span style="color: #008000">// üëà  absolute namespace</span>
<span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #001080">Self</span><span style="color: #000000">.</span><span style="color: #795E26">apply</span><span style="color: #000000">(</span><span style="color: #001080">Person</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">hobbies:</span><span style="color: #000000"> {</span>
<span style="color: #000000">      </span><span style="color: #008000">//&#039;*&#039;: Person.Hobby // üëà  symbol not yet known</span>
<span style="color: #000000">        </span><span style="color: #A31515">&#039;*&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> (() </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">Person</span><span style="color: #000000">.</span><span style="color: #001080">Hobby</span><span style="color: #000000">)() </span><span style="color: #008000">// üëà  IIFE to the rescue</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">})</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> { </span><span style="color: #008000">// üëà &quot;org.example.peopleHobbies.Person&quot;</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">hobbies</span><span style="color: #000000">?: </span><span style="color: #267F99">Person</span><span style="color: #000000">.</span><span style="color: #267F99">Hobby</span><span style="color: #000000">[]</span>
<span style="color: #000000">    ) {}</span>
<span style="color: #000000">}</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">namespace</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Hobby</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">        </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #001080">Self</span><span style="color: #000000">.</span><span style="color: #795E26">apply</span><span style="color: #000000">(</span><span style="color: #001080">Hobby</span><span style="color: #000000">),</span>
<span style="color: #000000">        </span><span style="color: #001080">startDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">    })</span>
<span style="color: #000000">    @</span><span style="color: #795E26">Namespace</span><span style="color: #000000">(</span><span style="color: #001080">Person</span><span style="color: #000000">) </span><span style="color: #008000">// üëà  relative namespace</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Hobby</span><span style="color: #000000"> { </span><span style="color: #008000">// üëà &quot;org.example.peopleHobbies.Person.Hobby&quot;</span>
<span style="color: #000000">        </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">            </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">hobby</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">            </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">startDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">        ) {}</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<blockquote>
					<p>Remember that Jsonizer&#39;s namespaces and Typescript&#39;s namespaces don&#39;t serve the same purpose</p>
				</blockquote>
				<a href="#reviving-parsed-data" id="reviving-parsed-data" style="color: inherit; text-decoration: none;">
					<h2>Reviving parsed data</h2>
				</a>
				<p>Sometimes, instead of parsing the JSON text representation, you already get a JSON data structure, but not augmented by a reviver, typically with HTTP <code>fetch()</code>.</p>
				<p>Jsonizer allows to revive existing not augmented data.</p>
				<p>So, instead of having this :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personReviver</span><span style="color: #000000"> = </span><span style="color: #001080">Reviver</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #001080">Person</span><span style="color: #000000">);</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personFromJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">personJson</span><span style="color: #000000">, </span><span style="color: #001080">personReviver</span><span style="color: #000000">);</span>
</code></pre>
				<p>Apply the reviver directly on the data structure :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personFromJsonNotRevived</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">personJson</span><span style="color: #000000">); </span><span style="color: #008000">// or HTTP fetch()</span>
<span style="color: #008000">// then you have your data structure, but not augmented with the expected types</span>

<span style="color: #008000">// üëç  just launch the reviver on it</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personReviver</span><span style="color: #000000"> = </span><span style="color: #001080">Reviver</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #001080">Person</span><span style="color: #000000">);</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personFromJson</span><span style="color: #000000"> = </span><span style="color: #795E26">personReviver</span><span style="color: #000000">(</span><span style="color: #001080">personFromJsonNotRevived</span><span style="color: #000000">);</span>
</code></pre>
				<a href="#reviver-generation" id="reviver-generation" style="color: inherit; text-decoration: none;">
					<h2>Reviver generation</h2>
				</a>
				<p>So far, each time we used <code>JSON.parse()</code> we passed it a reviver that we do defined. With some applications, for example when passing data through web sockets, you will juste parse some data without knowing which type it is.</p>
				<p>Jsonizer allow to generate a relevant reviver during JSON serialization, and to use it later with <code>JSON.parse()</code>.</p>
				<a href="#replacer" id="replacer" style="color: inherit; text-decoration: none;">
					<h3>Replacer</h3>
				</a>
				<p>To generate a reviver, pass Jsonizer&#39;s replacer to <code>JSON.stringify()</code>, it is a replacer that captures every reviver encountered during stringification :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">data</span><span style="color: #000000"> = </span><span style="color: #795E26">getData</span><span style="color: #000000">(); </span><span style="color: #008000">// can be different things</span>
<span style="color: #008000">// create a context for the capture :</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">replacer</span><span style="color: #000000"> = </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #795E26">replacer</span><span style="color: #000000">();</span>
<span style="color: #008000">// stringify with our replacer that also capture the mappings</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">jsonData</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">data</span><span style="color: #000000">, </span><span style="color: #001080">replacer</span><span style="color: #000000">);</span>

<span style="color: #008000">// every class decorated with `@Reviver` were captured</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">jsonReviver</span><span style="color: #000000"> = </span><span style="color: #001080">replacer</span><span style="color: #000000">.</span><span style="color: #795E26">toString</span><span style="color: #000000">()</span>
<span style="color: #008000">// NOTE: similar result with :</span>
<span style="color: #008000">// const jsonReviver = JSON.stringify(replacer.getReviver());</span>

<span style="color: #795E26">sendOrStoreOrWhatever</span><span style="color: #000000">(</span><span style="color: #001080">jsonData</span><span style="color: #000000">, </span><span style="color: #001080">jsonReviver</span><span style="color: #000000">);</span>
</code></pre>
				<p>To respawn the data, pass the reviver to <code>JSON.parse()</code> :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">parseData</span><span style="color: #000000">(</span><span style="color: #001080">jsonData</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">, </span><span style="color: #001080">jsonReviver</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #008000">// revive the reviver                          üëá get the reviver for revivers</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">reviver</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">jsonReviver</span><span style="color: #000000">, </span><span style="color: #001080">Reviver</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">());</span>
<span style="color: #000000">    </span><span style="color: #008000">// revive the data with the reviver</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">jsonData</span><span style="color: #000000">, </span><span style="color: #001080">reviver</span><span style="color: #000000">);</span>
<span style="color: #000000">}</span>
</code></pre>
				<ul>
					<li>Example with a class :<pre><code class="language-typescript"><span style="color: #008000">// with </span>
<span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">getData</span><span style="color: #000000">() {</span>
<span style="color: #000000">  </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Person</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Bob&#039;</span><span style="color: #000000">, </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;1998-10-21&#039;</span><span style="color: #000000">));</span>
<span style="color: #000000">}</span>
<span style="color: #008000">// jsonReviver might be :</span>
<span style="color: #008000">// {&quot;.&quot;:&quot;org.example.people.Person&quot;}</span>
</code></pre>
					</li>
				</ul>
				<blockquote>
					<p>Above, the <code>Person</code> class was set in a namespace.</p>
				</blockquote>
				<ul>
					<li><p>Example with an array :</p>
						<pre><code class="language-typescript"><span style="color: #008000">// with </span>
<span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">getData</span><span style="color: #000000">() {</span>
<span style="color: #000000">  </span><span style="color: #AF00DB">return</span><span style="color: #000000"> [</span>
<span style="color: #000000">      </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Person</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Bob&#039;</span><span style="color: #000000">, </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;1998-10-21&#039;</span><span style="color: #000000">), [</span>
<span style="color: #000000">          {   </span><span style="color: #001080">hobby:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;programming&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">              </span><span style="color: #001080">startDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;2021-01-01&#039;</span><span style="color: #000000">),</span>
<span style="color: #000000">          },</span>
<span style="color: #000000">          {   </span><span style="color: #001080">hobby:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;cooking&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">              </span><span style="color: #001080">endDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;2020-12-31&#039;</span><span style="color: #000000">),</span>
<span style="color: #000000">          },</span>
<span style="color: #000000">      ]),</span>
<span style="color: #000000">      </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Person</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Alice&#039;</span><span style="color: #000000">, </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;2002-04-01&#039;</span><span style="color: #000000">))</span>
<span style="color: #000000">  ];</span>
<span style="color: #000000">}</span>
<span style="color: #008000">// jsonReviver might be :</span>
<span style="color: #008000">// {&quot;*&quot;:&quot;org.example.people.Person&quot;}</span>
</code></pre>
					</li>
					<li><p>Example with nested structure :</p>
						<pre><code class="language-typescript"><span style="color: #008000">// with :</span>
<span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">getData</span><span style="color: #000000">() {</span>
<span style="color: #000000">  </span><span style="color: #AF00DB">return</span><span style="color: #000000"> [</span>
<span style="color: #000000">      {</span>
<span style="color: #000000">          </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;Bob&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">          </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;1998-10-21&#039;</span><span style="color: #000000">),</span>
<span style="color: #000000">          </span><span style="color: #001080">hobbies:</span><span style="color: #000000"> [</span>
<span style="color: #000000">              {   </span><span style="color: #001080">hobby:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;programming&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">                  </span><span style="color: #001080">startDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;2021-01-01&#039;</span><span style="color: #000000">),</span>
<span style="color: #000000">              },</span>
<span style="color: #000000">              {   </span><span style="color: #001080">hobby:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;cooking&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">                  </span><span style="color: #001080">endDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;2020-12-31&#039;</span><span style="color: #000000">),</span>
<span style="color: #000000">              },</span>
<span style="color: #000000">          ]</span>
<span style="color: #000000">      }, {</span>
<span style="color: #000000">          </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;Alice&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">          </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;2002-04-01&#039;</span><span style="color: #000000">),</span>
<span style="color: #000000">      }</span>
<span style="color: #000000">  ];</span>
<span style="color: #008000">// jsonReviver will be :</span>
<span style="color: #008000">// {  &#039;*&#039;: {</span>
<span style="color: #008000">//        birthDate: Date,</span>
<span style="color: #008000">//        hobbies: {</span>
<span style="color: #008000">//            &#039;*&#039;: {</span>
<span style="color: #008000">//                startDate: Date,</span>
<span style="color: #008000">//                endDate: Date</span>
<span style="color: #008000">//            }</span>
<span style="color: #008000">//        }</span>
<span style="color: #008000">//    }</span>
<span style="color: #008000">// }</span>
</code></pre>
					</li>
				</ul>
				<blockquote>
					<p>Adjacent nested structures are merged when possible to reduce the required mappings. The optimization is smart enough to almost produce what you would have design by yourself.</p>
				</blockquote>
				<a href="#subreviver" id="subreviver" style="color: inherit; text-decoration: none;">
					<h3>Subreviver</h3>
				</a>
				<p>Taking a reviver, it is possible to extract a subreviver from it :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">interface</span><span style="color: #000000"> </span><span style="color: #267F99">Hobby</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">hobby</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">startDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span>
<span style="color: #000000">}</span>

<span style="color: #000000">@</span><span style="color: #795E26">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">&gt;({ </span><span style="color: #008000">// üëà  an &quot;all-in-one&quot; reviver</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #001080">Self</span><span style="color: #000000">.</span><span style="color: #795E26">apply</span><span style="color: #000000">(</span><span style="color: #001080">Person</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #001080">birthDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">hobbies:</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #A31515">&#039;*&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #001080">startDate:</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">})</span>
<span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">birthDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">hobbies</span><span style="color: #000000">?: </span><span style="color: #267F99">Hobby</span><span style="color: #000000">[]</span>
<span style="color: #000000">    ) {}</span>
<span style="color: #000000">}</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">hobbies</span><span style="color: #000000"> = [</span>
<span style="color: #000000">    {   </span><span style="color: #001080">hobby:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;programming&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">startDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;2021-01-01&#039;</span><span style="color: #000000">),</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">    {   </span><span style="color: #001080">hobby:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;cooking&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">startDate:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Date</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;2020-12-31&#039;</span><span style="color: #000000">),</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">];</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">jsonHobbies</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">hobbies</span><span style="color: #000000">);</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personReviver</span><span style="color: #000000"> = </span><span style="color: #001080">Reviver</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #001080">Person</span><span style="color: #000000">);</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">hobbiesReviver</span><span style="color: #000000"> = </span><span style="color: #001080">personReviver</span><span style="color: #000000">.</span><span style="color: #001080">hobbies</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Hobby</span><span style="color: #000000">[]&gt;; </span><span style="color: #008000">// üëà  a subreviver</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">hobbiesFromJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">jsonHobbies</span><span style="color: #000000">, </span><span style="color: #001080">hobbiesReviver</span><span style="color: #000000">); </span><span style="color: #008000">// üëà  as usual</span>
</code></pre>
				<p>This is not the same as taking the field from the mapper (the mapper is just a plain javascript object), therefore there is no subreviver for <code>&#39;*&#39;</code>, neither for ranges and RegExp ; instead, you may ask whether there is a subreviver for a given key, and you will get the most relevant reviver :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">jsonHobby</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">hobbies</span><span style="color: #000000">[</span><span style="color: #098658">0</span><span style="color: #000000">]);</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">hobbyReviver</span><span style="color: #000000"> = </span><span style="color: #001080">personReviver</span><span style="color: #000000">.</span><span style="color: #001080">hobbies</span><span style="color: #000000">[</span><span style="color: #098658">0</span><span style="color: #000000">] </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">Reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Hobby</span><span style="color: #000000">&gt;; </span><span style="color: #008000">// üëà  a subreviver that matches the &#039;*&#039; entry</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">hobbyFromJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">jsonHobby</span><span style="color: #000000">, </span><span style="color: #001080">hobbyReviver</span><span style="color: #000000">); </span><span style="color: #008000">// üëà  as usual</span>
</code></pre>
				<a href="#dynamic-reviver" id="dynamic-reviver" style="color: inherit; text-decoration: none;">
					<h3>Dynamic reviver</h3>
				</a>
				<p>It is possible to send through some channel the payload data and its reviver bundled in a single JSON data structure ; and in the other side to revive the reviver then using it to parse the data.</p>
				<p>From that bases, it is possible to design a dynamic reviver :</p>
				<ul>
					<li>where the data must be sequentially after its reviver (because it is required to augment the payload data)</li>
					<li>where the JSON bundle have to be created artificially (because the reviver is ready after stringify ends)</li>
				</ul>
				<p>For example, if we intend to send the tuple <code>[jsonReviver, jsonData]</code> :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">data</span><span style="color: #000000"> = </span><span style="color: #795E26">getData</span><span style="color: #000000">(); </span><span style="color: #008000">// can be different things</span>
<span style="color: #008000">// create a context for the capture :</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">replacer</span><span style="color: #000000"> = </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #795E26">replacer</span><span style="color: #000000">();</span>
<span style="color: #008000">// stringify with our replacer that also capture the mappings</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">jsonData</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">data</span><span style="color: #000000">, </span><span style="color: #001080">replacer</span><span style="color: #000000">);</span>
<span style="color: #008000">// every class decorated with `@Reviver` were captured</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">jsonReviver</span><span style="color: #000000"> = </span><span style="color: #001080">replacer</span><span style="color: #000000">.</span><span style="color: #795E26">toString</span><span style="color: #000000">();</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">jsonTuple</span><span style="color: #000000"> = </span><span style="color: #A31515">`[</span><span style="color: #0000FF">${</span><span style="color: #001080">jsonReviver</span><span style="color: #0000FF">}</span><span style="color: #A31515">,</span><span style="color: #0000FF">${</span><span style="color: #001080">jsonData</span><span style="color: #0000FF">}</span><span style="color: #A31515">]`</span><span style="color: #000000">; </span><span style="color: #008000">// üëà  a tuple to send as a JSON string</span>
</code></pre>
				<p>On the other side of the channel :</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">jsonTuple</span><span style="color: #000000"> = ... </span><span style="color: #008000">// get the data somehow</span>
<span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">reviver</span><span style="color: #000000">: </span><span style="color: #267F99">Reviver</span><span style="color: #000000">; </span><span style="color: #008000">// üëà  will hold the Reviver = jsonTuple[0]</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">dynamicReviver</span><span style="color: #000000"> = </span><span style="color: #001080">Jsonizer</span><span style="color: #000000">.</span><span style="color: #795E26">reviver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">any</span><span style="color: #000000">, [</span><span style="color: #267F99">Reviver</span><span style="color: #000000">, </span><span style="color: #267F99">any</span><span style="color: #000000">]&gt;({ </span><span style="color: #008000">// üëà  tuple signature is [Reviver, any]</span>
<span style="color: #000000">    </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> ([</span><span style="color: #001080">_rev_</span><span style="color: #000000">, </span><span style="color: #001080">data</span><span style="color: #000000">]) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">data</span><span style="color: #000000">, </span><span style="color: #008000">// üëà  just return the data</span>
<span style="color: #000000">    </span><span style="color: #098658">0</span><span style="color: #001080">:</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #A31515">&#039;.&#039;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">jsonReviver</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">reviver</span><span style="color: #000000"> = </span><span style="color: #001080">Reviver</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">()(</span><span style="color: #001080">jsonReviver</span><span style="color: #000000">) </span><span style="color: #008000">// üëà  revive the reviver </span>
<span style="color: #000000">    },</span>
<span style="color: #000000">    </span><span style="color: #098658">1</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Proxy</span><span style="color: #000000">({}, { </span><span style="color: #008000">// üëà  delegate to the reviver </span>
<span style="color: #000000">        </span><span style="color: #795E26">get</span><span style="color: #001080">:</span><span style="color: #000000"> (</span><span style="color: #001080">obj</span><span style="color: #000000">, </span><span style="color: #001080">prop</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">reviver</span><span style="color: #000000">[</span><span style="color: #001080">prop</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">any</span><span style="color: #000000">],</span>
<span style="color: #000000">        </span><span style="color: #795E26">ownKeys</span><span style="color: #001080">:</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #267F99">Reflect</span><span style="color: #000000">.</span><span style="color: #795E26">ownKeys</span><span style="color: #000000">(</span><span style="color: #001080">reviver</span><span style="color: #000000">), </span>
<span style="color: #000000">        </span><span style="color: #795E26">getPrototypeOf</span><span style="color: #001080">:</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #267F99">Reflect</span><span style="color: #000000">.</span><span style="color: #795E26">getPrototypeOf</span><span style="color: #000000">(</span><span style="color: #001080">reviver</span><span style="color: #000000">)</span>
<span style="color: #000000">    })</span>
<span style="color: #000000">});</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">dataFromJson</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">jsonTuple</span><span style="color: #000000">, </span><span style="color: #001080">dynamicReviver</span><span style="color: #000000">); </span><span style="color: #008000">// üëà  you have it</span>
<span style="color: #008000">// as usual, dataFromJson contains augmented typed data</span>
</code></pre>
				<a href="#optimization" id="optimization" style="color: inherit; text-decoration: none;">
					<h3>Optimization</h3>
				</a>
				<p>When generating the revivers, objects that are not class instances may have a small impact on performances.</p>
				<p>Classes are short-circuit, since they are referred with their qualified names and embed themselves the recipes of reviving ; conversely, objects that are not class instances need to generate the mappings of their hierarchy, and some optimizations are made for merging adjacent mappings on arrays. However, arrays or tuples of class instances don&#39;t suffer of such penalty.</p>
				<a href="#asynchronizer" id="asynchronizer" style="color: inherit; text-decoration: none;">
					<h3>Asynchronizer</h3>
				</a>
				<p>Jsonizer fits well in <a href="https://badcafe.github.io/asynchronizer">Asynchronizer</a>.</p>
				<p>Asynchronizer allows to define consistent <a href="https://en.wikipedia.org/wiki/Remote_procedure_call">RPC functions</a> to send objects as JSON data through various channels (Web socket, HTTP, node clusters, web workers, etc), manages asynchronous return values or errors, handles broadcasting and multicasting, etc.</p>
				<p>In Asynchronizer, a new component called a data transfer handler (DTH) is used to describe a group of RPC functions (like a service, but a service is strongly related to client-server exchange, whereas a DTH is a more general concept) :</p>
				<ul>
					<li><p><code>myApp-shared</code></p>
						<pre><code class="language-typescript"><span style="color: #008000">// see Person class definition in previous example</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">namespace</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #008000">// see Hobby class definition in previous example</span>

<span style="color: #000000">  </span><span style="color: #0000FF">interface</span><span style="color: #000000"> </span><span style="color: #267F99">DTH</span><span style="color: #000000"> {  </span><span style="color: #008000">// üëà  a Data Transfer Handler</span>
<span style="color: #000000">      </span><span style="color: #795E26">getPersonByName</span><span style="color: #000000">(</span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">): </span><span style="color: #267F99">Person</span><span style="color: #000000"> </span><span style="color: #008000">// well, I didn&#039;t set an ID on Person ü•¥</span>
<span style="color: #000000">      </span><span style="color: #795E26">getPersonsByBirthDate</span><span style="color: #000000">(</span><span style="color: #001080">date</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000">): </span><span style="color: #267F99">Person</span><span style="color: #000000">[]</span>
<span style="color: #000000">      </span><span style="color: #795E26">getPersonsWithHobby</span><span style="color: #000000">(</span><span style="color: #001080">hobby</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">[], </span><span style="color: #001080">startDate</span><span style="color: #000000">: </span><span style="color: #267F99">Date</span><span style="color: #000000">): </span><span style="color: #267F99">Person</span><span style="color: #000000">[]</span>
<span style="color: #000000">  }</span>
<span style="color: #000000">}</span>
</code></pre>
					</li>
				</ul>
				<p>Applications made with Asynchronizer are usually isomorphic applications with at least 3 parts :</p>
				<ul>
					<li><code>myApp-shared</code> : contains the classes definition with their DTH (the snippet code above)</li>
					<li><code>myApp-client</code> : is the client app ; it will use <code>Person.DTH</code> to ask for the data</li>
					<li><code>myApp-server</code> : is the server app ; it will implement <code>Person.DTH</code> to respond to the client</li>
				</ul>
				<p>Say that we are using a web socket channel between the client and server ; the client may invoke the server like this :</p>
				<ul>
					<li><code>myApp-client</code><pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">ws</span><span style="color: #000000"> = ... </span><span style="color: #008000">// create a client web socket for the path &#039;/ws&#039;</span>
<span style="color: #008000">// create a channel and get its transfer handler</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">th</span><span style="color: #000000"> = </span><span style="color: #001080">SocketClientChannel</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #001080">ws</span><span style="color: #000000">).</span><span style="color: #795E26">transferHandler</span><span style="color: #000000">(); </span><span style="color: #008000">// üëà  1 line conf for Asynchronizer</span>
<span style="color: #008000">// create a socket client proxy to send messages</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">personDTH</span><span style="color: #000000"> = </span><span style="color: #001080">th</span><span style="color: #000000">.</span><span style="color: #795E26">bindSender</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">.</span><span style="color: #267F99">DTH</span><span style="color: #000000">&gt;(</span><span style="color: #001080">Person</span><span style="color: #000000">); </span><span style="color: #008000">// a sender is a stateless singleton</span>
<span style="color: #008000">// send messages on button click</span>
<span style="color: #001080">someButton</span><span style="color: #000000">.</span><span style="color: #795E26">addEventListener</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;click&#039;</span><span style="color: #000000">, </span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #001080">ev</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #001080">ev</span><span style="color: #000000">.</span><span style="color: #795E26">preventDefault</span><span style="color: #000000">();</span>
<span style="color: #000000">  </span><span style="color: #008000">// Asynchronizer turns the RPC function</span>
<span style="color: #000000">  </span><span style="color: #008000">//    to an async function üëá</span>
<span style="color: #000000">  </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">persons</span><span style="color: #000000">: </span><span style="color: #267F99">Person</span><span style="color: #000000">[] = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">personDTH</span><span style="color: #000000">.</span><span style="color: #795E26">getPersonsByBirthDate</span><span style="color: #000000">(</span><span style="color: #001080">someDate</span><span style="color: #000000">);</span>
<span style="color: #000000">  </span><span style="color: #008000">//    üëÜ Asynchronizer transparently revive the persons and stringify üëÜ the date</span>
<span style="color: #000000">  </span><span style="color: #795E26">renderHTMLPersonsView</span><span style="color: #000000">(</span><span style="color: #001080">persons</span><span style="color: #000000">);</span>
<span style="color: #000000">  </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #0000FF">false</span><span style="color: #000000">;</span>
<span style="color: #000000">}, </span><span style="color: #0000FF">true</span><span style="color: #000000">);</span>
</code></pre>
					</li>
				</ul>
				<p>Server side, we have to implement the RPC functions of the interface :</p>
				<ul>
					<li><code>myApp-server</code><pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">ws</span><span style="color: #000000"> = ... </span><span style="color: #008000">// create and configure a web socket server...</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">th</span><span style="color: #000000"> = </span><span style="color: #001080">SocketServerChannel</span><span style="color: #000000">.</span><span style="color: #795E26">get</span><span style="color: #000000">(</span><span style="color: #001080">ws</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;/ws&#039;</span><span style="color: #000000">).</span><span style="color: #795E26">transferHandler</span><span style="color: #000000">(); </span><span style="color: #008000">// üëà  1 line conf for Asynchronizer</span>
<span style="color: #008000">// receives messages from the client</span>
<span style="color: #001080">th</span><span style="color: #000000">.</span><span style="color: #795E26">bindReceiver</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Person</span><span style="color: #000000">.</span><span style="color: #267F99">DTH</span><span style="color: #000000">&gt;(</span><span style="color: #001080">Person</span><span style="color: #000000">, { </span><span style="color: #008000">// a receiver is a stateless singleton</span>
<span style="color: #008000">// üëá Asynchronizer turns the RPC functions to async functions</span>
<span style="color: #000000">  </span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #795E26">getPersonsByBirthDate</span><span style="color: #000000">(</span><span style="color: #001080">date</span><span style="color: #000000">) {</span>
<span style="color: #000000">                            </span><span style="color: #008000">// üëÜ Asynchronizer transparently revive the date...</span>
<span style="color: #000000">      </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">persons</span><span style="color: #000000">: </span><span style="color: #267F99">Person</span><span style="color: #000000">[] = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">getPersonByBirthDate</span><span style="color: #000000">(</span><span style="color: #001080">date</span><span style="color: #000000">);</span>
<span style="color: #000000">      </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">persons</span><span style="color: #000000">; </span><span style="color: #008000">// üëà  ...and stringify the persons</span>
<span style="color: #000000">  },</span>
<span style="color: #000000">  </span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #795E26">getPersonsWithHobby</span><span style="color: #000000">(</span><span style="color: #001080">hobby</span><span style="color: #000000">, </span><span style="color: #001080">startDate</span><span style="color: #000000">) {</span>
<span style="color: #000000">      </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">persons</span><span style="color: #000000">: </span><span style="color: #267F99">Person</span><span style="color: #000000">[] = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">getPersonsWithHobby</span><span style="color: #000000">(</span><span style="color: #001080">hobby</span><span style="color: #000000">, </span><span style="color: #001080">startDate</span><span style="color: #000000">.</span><span style="color: #795E26">getFullYear</span><span style="color: #000000">());</span>
<span style="color: #000000">      </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">persons</span><span style="color: #000000">;                          </span><span style="color: #008000">// look, it&#039;s a Date instance üëÜ</span>
<span style="color: #000000">  },</span>
<span style="color: #000000">  </span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #795E26">getPersonByName</span><span style="color: #000000">(</span><span style="color: #001080">name</span><span style="color: #000000">) {</span>
<span style="color: #000000">      </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">store</span><span style="color: #000000">.</span><span style="color: #795E26">getPersonByName</span><span style="color: #000000">(</span><span style="color: #001080">name</span><span style="color: #000000">);</span>
<span style="color: #000000">  }</span>
<span style="color: #000000">});</span>
</code></pre>
					</li>
				</ul>
				<p>Above :</p>
				<ul>
					<li>the types are inferred from the signature of the DTH interface,</li>
					<li>and Jsonizer transparently revive the arguments to the expected objects instances.</li>
				</ul>
				<p>In fact, when using Asynchronizer, you just have to decorate your classes with <code>@Reviver</code> and <code>@Namespace</code>, and your instances will be revived client-side and server-side thanks to Jsonizer.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Exports</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/jsonizer.html">jsonizer</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/namespace.html">namespace</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/util.html">util</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer>
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-namespace"><span class="tsd-kind-icon">Namespace</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-type-alias tsd-has-type-parameter"><span class="tsd-kind-icon">Type alias with type parameter</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>